============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-7.4.4, pluggy-1.6.0 -- /home/mikeb/work/nano/.auto-claude/worktrees/tasks/052-reduce-neuromanifoldblock-parameter-explosion-with/venv/bin/python3
cachedir: .pytest_cache
rootdir: /home/mikeb/work/nano/.auto-claude/worktrees/tasks/052-reduce-neuromanifoldblock-parameter-explosion-with
plugins: cov-4.1.0
collecting ... collected 686 items

neuromanifold_gpt/tests/test_alibi.py::test_alibi_initialization PASSED  [  0%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_forward_shape PASSED   [  0%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_different_seq_lengths PASSED [  0%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_cache_extension PASSED [  0%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_slopes_power_of_2 PASSED [  0%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_slopes_non_power_of_2 PASSED [  0%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_bias_formula PASSED    [  1%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_diagonal_is_zero PASSED [  1%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_symmetry PASSED        [  1%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_negative_values PASSED [  1%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_increasing_penalty_with_distance PASSED [  1%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_different_slopes_per_head PASSED [  1%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_single_token PASSED    [  1%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_no_learnable_parameters PASSED [  2%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_deterministic PASSED   [  2%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_device_consistency PASSED [  2%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_dtype_consistency PASSED [  2%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_broadcast_compatibility PASSED [  2%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_extrapolation PASSED   [  2%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_head_specialization PASSED [  2%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_linear_scaling PASSED  [  3%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_small_head_count PASSED [  3%]
neuromanifold_gpt/tests/test_alibi.py::test_alibi_large_head_count PASSED [  3%]
neuromanifold_gpt/tests/test_block.py::test_block_forward_shape PASSED   [  3%]
neuromanifold_gpt/tests/test_block.py::test_block_gradient_flow PASSED   [  3%]
neuromanifold_gpt/tests/test_block_integration.py::test_full_block_integration PASSED [  3%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANLinear::test_initialization PASSED [  3%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANLinear::test_forward_shape PASSED [  4%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANLinear::test_backward_pass PASSED [  4%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANLinear::test_numerical_stability PASSED [  4%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANLinear::test_normalization_range PASSED [  4%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANLinear::test_different_degrees[3] PASSED [  4%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANLinear::test_different_degrees[4] PASSED [  4%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANLinear::test_different_degrees[5] PASSED [  4%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANLinear::test_no_bias PASSED [  5%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANFFN::test_forward_shape PASSED [  5%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANFFN::test_backward_pass PASSED [  5%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANFFN::test_dropout_behavior PASSED [  5%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANFFN::test_residual_compatibility PASSED [  5%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANFFN::test_numerical_stability PASSED [  5%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestCausalityPreservation::test_no_future_leakage PASSED [  5%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestCausalityPreservation::test_position_independence PASSED [  6%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyshevPolynomialProperties::test_polynomial_computation PASSED [  6%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyshevPolynomialProperties::test_orthogonality_hint PASSED [  6%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANCUDA::test_cuda_forward PASSED [  6%]
neuromanifold_gpt/tests/test_cheby_kan.py::TestChebyKANCUDA::test_cuda_backward PASSED [  6%]
neuromanifold_gpt/tests/test_component_metrics_integration.py::test_full_component_metrics_integration PASSED [  6%]
neuromanifold_gpt/tests/test_component_metrics_integration.py::test_component_metrics_partial_info PASSED [  6%]
neuromanifold_gpt/tests/test_component_metrics_integration.py::test_component_metrics_no_sdr PASSED [  7%]
neuromanifold_gpt/tests/test_component_metrics_integration.py::test_component_metrics_empty_info PASSED [  7%]
neuromanifold_gpt/tests/test_component_metrics_integration.py::test_component_metrics_aggregation_across_blocks PASSED [  7%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfig::test_config_defaults PASSED [  7%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfig::test_config_n_embd_divisible_by_heads FAILED [  7%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfig::test_config_valid_n_embd_and_heads PASSED [  7%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfig::test_config_sdr_n_active_computed PASSED [  8%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfig::test_config_model_architecture_defaults PASSED [  8%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfig::test_config_manifold_defaults PASSED [  8%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfig::test_config_fhn_defaults PASSED [  8%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfig::test_config_engram_defaults PASSED [  8%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfig::test_config_dag_and_imagination_defaults PASSED [  8%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfigNano::test_nano_preset_exists PASSED [  8%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfigNano::test_nano_preset_values PASSED [  9%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfigNano::test_nano_preset_reduced_manifold PASSED [  9%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfigNano::test_nano_preset_sdr_n_active_computed PASSED [  9%]
neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfigNano::test_nano_preset_inherits_from_base PASSED [  9%]
neuromanifold_gpt/tests/test_config.py::TestConfigValidation::test_sdr_sparsity_affects_n_active PASSED [  9%]
neuromanifold_gpt/tests/test_config.py::TestConfigValidation::test_head_dim_computed_correctly PASSED [  9%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigDependencyValidation::test_n_embd_divisible_by_n_heads_valid PASSED [  9%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigDependencyValidation::test_n_embd_not_divisible_by_n_heads_raises PASSED [ 10%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigDependencyValidation::test_memory_active_retrieval_requires_use_sdr PASSED [ 10%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigDependencyValidation::test_memory_active_retrieval_with_use_sdr_valid PASSED [ 10%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigDependencyValidation::test_memory_active_retrieval_false_with_use_sdr_false_valid PASSED [ 10%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigDependencyValidation::test_fast_mode_enables_fast_path_optimizations PASSED [ 10%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigDependencyValidation::test_fast_mode_caps_sdr_size PASSED [ 10%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigDependencyValidation::test_sdr_n_active_computed_from_size_and_sparsity PASSED [ 10%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigDependencyValidation::test_head_dim_property_computed_correctly PASSED [ 11%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigNanoValidation::test_nano_config_inherits_validation PASSED [ 11%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigNanoValidation::test_nano_config_memory_retrieval_dependency PASSED [ 11%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigNanoValidation::test_nano_config_sdr_n_active_computed PASSED [ 11%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigNanoValidation::test_nano_config_head_dim_valid PASSED [ 11%]
neuromanifold_gpt/tests/test_config_validation.py::TestConfigNanoValidation::test_nano_config_fast_mode_enables_optimizations PASSED [ 11%]
neuromanifold_gpt/tests/test_config_validation.py::TestMultiscaleManifoldValidation::test_multiscale_dimensions_hierarchical PASSED [ 11%]
neuromanifold_gpt/tests/test_config_validation.py::TestMultiscaleManifoldValidation::test_multiscale_fine_dim_matches_manifold_dim PASSED [ 12%]
neuromanifold_gpt/tests/test_config_validation.py::TestMultiscaleManifoldValidation::test_multiscale_custom_dimensions PASSED [ 12%]
neuromanifold_gpt/tests/test_config_validation.py::TestAdvancedFeatureValidation::test_moe_configuration_valid PASSED [ 12%]
neuromanifold_gpt/tests/test_config_validation.py::TestAdvancedFeatureValidation::test_mla_configuration_valid PASSED [ 12%]
neuromanifold_gpt/tests/test_config_validation.py::TestAdvancedFeatureValidation::test_mtp_configuration_valid PASSED [ 12%]
neuromanifold_gpt/tests/test_config_validation.py::TestAdvancedFeatureValidation::test_hybrid_reasoning_configuration_valid PASSED [ 12%]
neuromanifold_gpt/tests/test_config_validation.py::TestAdvancedFeatureValidation::test_dag_planner_configuration_valid PASSED [ 12%]
neuromanifold_gpt/tests/test_config_validation.py::TestAdvancedFeatureValidation::test_hierarchical_memory_configuration_valid PASSED [ 13%]
neuromanifold_gpt/tests/test_config_validation.py::TestAdvancedFeatureValidation::test_imagination_configuration_valid PASSED [ 13%]
neuromanifold_gpt/tests/test_config_validation.py::TestTrainingConfigValidation::test_lr_schedule_valid_values PASSED [ 13%]
neuromanifold_gpt/tests/test_config_validation.py::TestTrainingConfigValidation::test_lr_schedule_ratios_sum_to_one PASSED [ 13%]
neuromanifold_gpt/tests/test_config_validation.py::TestTrainingConfigValidation::test_optimizer_parameters_valid PASSED [ 13%]
neuromanifold_gpt/tests/test_config_validation.py::TestTrainingConfigValidation::test_label_smoothing_valid_range PASSED [ 13%]
neuromanifold_gpt/tests/test_config_validation.py::TestKANConfigValidation::test_kan_type_valid_values PASSED [ 13%]
neuromanifold_gpt/tests/test_config_validation.py::TestKANConfigValidation::test_kan_wavelet_valid_values PASSED [ 14%]
neuromanifold_gpt/tests/test_config_validation.py::TestKANConfigValidation::test_kan_num_centers_positive PASSED [ 14%]
neuromanifold_gpt/tests/test_config_validation.py::TestMHCConfigValidation::test_mhc_configuration_valid PASSED [ 14%]
neuromanifold_gpt/tests/test_config_validation.py::TestMHCConfigValidation::test_mhc_residual_weight_valid_range PASSED [ 14%]
neuromanifold_gpt/tests/test_config_validation.py::TestMHCConfigValidation::test_mhc_sinkhorn_iters_positive PASSED [ 14%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderBasic::test_context_encoder_shape PASSED [ 14%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderBasic::test_context_encoder_local_attention PASSED [ 15%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderBasic::test_context_gate_bounded PASSED [ 15%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderBasic::test_context_encoder_deterministic PASSED [ 15%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderBasic::test_context_encoder_different_embed_dims PASSED [ 15%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderMask::test_local_mask_correctness PASSED [ 15%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderMask::test_mask_is_symmetric PASSED [ 15%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderMask::test_mask_caching FAILED [ 15%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderMask::test_mask_diagonal_always_false PASSED [ 16%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderGradients::test_context_encoder_gradient_flow PASSED [ 16%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderGradients::test_context_encoder_batch_independence PASSED [ 16%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderGradients::test_gradient_through_gate PASSED [ 16%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderConfig::test_from_config PASSED [ 16%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderConfig::test_from_nano_config PASSED [ 16%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderOptions::test_dropout_effect PASSED [ 16%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderOptions::test_no_layer_norm PASSED [ 17%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderOptions::test_with_layer_norm PASSED [ 17%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderOptions::test_extra_repr PASSED [ 17%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderValidation::test_invalid_n_heads FAILED [ 17%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderValidation::test_single_token_sequence PASSED [ 17%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderValidation::test_context_larger_than_sequence PASSED [ 17%]
neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderValidation::test_very_long_sequence PASSED [ 17%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_forward_shape FAILED [ 18%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_node_count_bounds FAILED [ 18%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_acyclic_structure FAILED [ 18%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_node_mask_consistency FAILED [ 18%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_adjacency_mask_application FAILED [ 18%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_deterministic_mode FAILED [ 18%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_complexity_positive FAILED [ 18%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_complexity_masking FAILED [ 19%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_surface_area_calculation FAILED [ 19%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_execution_order FAILED [ 19%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_execution_order_respects_dependencies FAILED [ 19%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_gradient_flow FAILED [ 19%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_batch_independence FAILED [ 19%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_empty_adjacency FAILED [ 19%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_training_vs_eval_mode FAILED [ 20%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_manifold_projection FAILED [ 20%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_different_sequence_lengths FAILED [ 20%]
neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_device_movement FAILED [ 20%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2SingleGPUConfig::test_config_loads PASSED [ 20%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2SingleGPUConfig::test_batch_size_calculation PASSED [ 20%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2SingleGPUConfig::test_config_values_are_sensible PASSED [ 20%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2SingleGPUConfig::test_eval_intervals_set PASSED [ 21%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2SingleGPUConfig::test_training_duration_set PASSED [ 21%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2SingleGPUConfig::test_wandb_configured PASSED [ 21%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2MultiGPUConfig::test_config_loads PASSED [ 21%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2MultiGPUConfig::test_batch_size_calculation_multi_gpu PASSED [ 21%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2MultiGPUConfig::test_multi_gpu_larger_than_single PASSED [ 21%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2MultiGPUConfig::test_gradient_accumulation_reflects_gpu_count PASSED [ 22%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2MultiGPUConfig::test_multi_gpu_config_values_sensible PASSED [ 22%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2MediumFinetuneConfig::test_config_loads PASSED [ 22%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2MediumFinetuneConfig::test_init_from_pretrained PASSED [ 22%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2MediumFinetuneConfig::test_finetuning_learning_rate PASSED [ 22%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2MediumFinetuneConfig::test_decay_lr_disabled PASSED [ 22%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2MediumFinetuneConfig::test_batch_size_calculation_finetune PASSED [ 22%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2MediumFinetuneConfig::test_shorter_training_for_finetune PASSED [ 23%]
neuromanifold_gpt/tests/test_default_configs.py::TestGPT2MediumFinetuneConfig::test_checkpoint_saving_config PASSED [ 23%]
neuromanifold_gpt/tests/test_default_configs.py::TestConfigCompatibility::test_all_configs_use_same_block_size PASSED [ 23%]
neuromanifold_gpt/tests/test_default_configs.py::TestConfigCompatibility::test_weight_decay_consistency PASSED [ 23%]
neuromanifold_gpt/tests/test_default_configs.py::TestConfigCompatibility::test_eval_config_consistency PASSED [ 23%]
neuromanifold_gpt/tests/test_default_configs.py::TestConfigFileStructure::test_single_gpu_has_comments PASSED [ 23%]
neuromanifold_gpt/tests/test_default_configs.py::TestConfigFileStructure::test_multi_gpu_has_launch_instructions PASSED [ 23%]
neuromanifold_gpt/tests/test_default_configs.py::TestConfigFileStructure::test_finetune_config_has_model_info PASSED [ 24%]
neuromanifold_gpt/tests/test_default_configs.py::TestConfigDefaults::test_single_gpu_has_all_required_params PASSED [ 24%]
neuromanifold_gpt/tests/test_default_configs.py::TestConfigDefaults::test_multi_gpu_has_all_required_params PASSED [ 24%]
neuromanifold_gpt/tests/test_default_configs.py::TestConfigDefaults::test_finetune_has_all_required_params PASSED [ 24%]
neuromanifold_gpt/tests/test_ema.py::TestEmaFFT::test_ema_fft_correctness PASSED [ 24%]
neuromanifold_gpt/tests/test_ema.py::TestEmaFFT::test_ema_fft_single_timestep PASSED [ 24%]
neuromanifold_gpt/tests/test_ema.py::TestEmaFFT::test_ema_fft_identity_alpha PASSED [ 24%]
neuromanifold_gpt/tests/test_ema.py::TestEmaFFT::test_ema_fft_small_alpha_error PASSED [ 25%]
neuromanifold_gpt/tests/test_ema.py::TestEmaFFT::test_ema_fft_per_channel_alpha PASSED [ 25%]
neuromanifold_gpt/tests/test_ema.py::TestEmaFFT::test_ema_fft_shape_preservation PASSED [ 25%]
neuromanifold_gpt/tests/test_ema.py::TestEmaFFT::test_ema_fft_causality PASSED [ 25%]
neuromanifold_gpt/tests/test_ema.py::TestEmaFFT::test_ema_fft_no_nan_inf PASSED [ 25%]
neuromanifold_gpt/tests/test_ema.py::TestEmaFFT::test_ema_fft_gradient_flow PASSED [ 25%]
neuromanifold_gpt/tests/test_ema.py::TestDampedEMA::test_damped_ema_fixed_alpha PASSED [ 25%]
neuromanifold_gpt/tests/test_ema.py::TestDampedEMA::test_damped_ema_learnable_alpha PASSED [ 26%]
neuromanifold_gpt/tests/test_ema.py::TestDampedEMA::test_damped_ema_per_channel_alpha PASSED [ 26%]
neuromanifold_gpt/tests/test_ema.py::TestDampedEMA::test_damped_ema_gradient_flow PASSED [ 26%]
neuromanifold_gpt/tests/test_ema.py::TestDampedEMA::test_damped_ema_extra_repr PASSED [ 26%]
neuromanifold_gpt/tests/test_ema.py::TestMultiHeadDampedEMA::test_multi_head_ema_basic PASSED [ 26%]
neuromanifold_gpt/tests/test_ema.py::TestMultiHeadDampedEMA::test_multi_head_ema_dimension_validation PASSED [ 26%]
neuromanifold_gpt/tests/test_ema.py::TestMultiHeadDampedEMA::test_multi_head_ema_learnable_alpha PASSED [ 26%]
neuromanifold_gpt/tests/test_ema.py::TestMultiHeadDampedEMA::test_multi_head_ema_per_head_alpha PASSED [ 27%]
neuromanifold_gpt/tests/test_ema.py::TestMultiHeadDampedEMA::test_multi_head_ema_per_channel_alpha PASSED [ 27%]
neuromanifold_gpt/tests/test_ema.py::TestMultiHeadDampedEMA::test_multi_head_ema_no_loops PASSED [ 27%]
neuromanifold_gpt/tests/test_ema.py::TestMultiHeadDampedEMA::test_multi_head_ema_extra_repr PASSED [ 27%]
neuromanifold_gpt/tests/test_ema.py::TestCEMA::test_cema_basic PASSED    [ 27%]
neuromanifold_gpt/tests/test_ema.py::TestCEMA::test_cema_dimension_validation PASSED [ 27%]
neuromanifold_gpt/tests/test_ema.py::TestCEMA::test_cema_learnable_alpha PASSED [ 27%]
neuromanifold_gpt/tests/test_ema.py::TestCEMA::test_cema_causality PASSED [ 28%]
neuromanifold_gpt/tests/test_ema.py::TestCEMA::test_cema_extra_repr PASSED [ 28%]
neuromanifold_gpt/tests/test_ema.py::TestEMANumericalStability::test_ema_large_sequence PASSED [ 28%]
neuromanifold_gpt/tests/test_ema.py::TestEMANumericalStability::test_ema_extreme_values PASSED [ 28%]
neuromanifold_gpt/tests/test_ema.py::TestEMANumericalStability::test_ema_alpha_boundary FAILED [ 28%]
neuromanifold_gpt/tests/test_ema.py::TestEMANumericalStability::test_ema_different_dtypes PASSED [ 28%]
neuromanifold_gpt/tests/test_ema.py::TestGradientFlow::test_gradient_flow PASSED [ 29%]
neuromanifold_gpt/tests/test_ema.py::TestEMAComplexity::test_ema_time_complexity FAILED [ 29%]
neuromanifold_gpt/tests/test_engram.py::test_engram_store_retrieve PASSED [ 29%]
neuromanifold_gpt/tests/test_engram.py::test_engram_capacity_limit PASSED [ 29%]
neuromanifold_gpt/tests/test_engram.py::test_engram_similarity_threshold PASSED [ 29%]
neuromanifold_gpt/tests/test_engram.py::test_engram_partial_overlap_retrieval PASSED [ 29%]
neuromanifold_gpt/tests/test_engram.py::test_engram_multiple_retrieval PASSED [ 29%]
neuromanifold_gpt/tests/test_engram.py::test_engram_clear PASSED         [ 30%]
neuromanifold_gpt/tests/test_engram.py::test_engram_empty_retrieval PASSED [ 30%]
neuromanifold_gpt/tests/test_engram.py::test_engram_device_movement PASSED [ 30%]
neuromanifold_gpt/tests/test_engram.py::test_engram_batch_retrieve PASSED [ 30%]
neuromanifold_gpt/tests/test_engram.py::test_engram_batch_retrieve_empty PASSED [ 30%]
neuromanifold_gpt/tests/test_engram.py::test_engram_batch_retrieve_threshold_filtering PASSED [ 30%]
neuromanifold_gpt/tests/test_engram.py::test_engram_batch_retrieve_variable_results PASSED [ 30%]
neuromanifold_gpt/tests/test_engram.py::test_engram_batch_retrieve_device_compatibility PASSED [ 31%]
neuromanifold_gpt/tests/test_engram.py::test_engram_batch_retrieve_padding PASSED [ 31%]
neuromanifold_gpt/tests/test_errors.py::TestNeuroManifoldError::test_base_error_with_all_fields PASSED [ 31%]
neuromanifold_gpt/tests/test_errors.py::TestNeuroManifoldError::test_base_error_with_only_problem PASSED [ 31%]
neuromanifold_gpt/tests/test_errors.py::TestNeuroManifoldError::test_base_error_with_partial_fields PASSED [ 31%]
neuromanifold_gpt/tests/test_errors.py::TestNeuroManifoldError::test_base_error_is_exception PASSED [ 31%]
neuromanifold_gpt/tests/test_errors.py::TestNeuroManifoldError::test_base_error_can_be_raised PASSED [ 31%]
neuromanifold_gpt/tests/test_errors.py::TestConfigurationError::test_configuration_error_inherits_from_base PASSED [ 32%]
neuromanifold_gpt/tests/test_errors.py::TestConfigurationError::test_configuration_error_with_all_fields PASSED [ 32%]
neuromanifold_gpt/tests/test_errors.py::TestConfigurationError::test_configuration_error_can_be_raised PASSED [ 32%]
neuromanifold_gpt/tests/test_errors.py::TestModelError::test_model_error_inherits_from_base PASSED [ 32%]
neuromanifold_gpt/tests/test_errors.py::TestModelError::test_model_error_with_model_loading_scenario PASSED [ 32%]
neuromanifold_gpt/tests/test_errors.py::TestModelError::test_model_error_can_be_raised PASSED [ 32%]
neuromanifold_gpt/tests/test_errors.py::TestValidationError::test_validation_error_inherits_from_base PASSED [ 32%]
neuromanifold_gpt/tests/test_errors.py::TestValidationError::test_validation_error_with_argument_validation_scenario PASSED [ 33%]
neuromanifold_gpt/tests/test_errors.py::TestValidationError::test_validation_error_can_be_raised PASSED [ 33%]
neuromanifold_gpt/tests/test_errors.py::TestRuntimeError::test_runtime_error_inherits_from_base PASSED [ 33%]
neuromanifold_gpt/tests/test_errors.py::TestRuntimeError::test_runtime_error_with_feature_not_enabled_scenario PASSED [ 33%]
neuromanifold_gpt/tests/test_errors.py::TestRuntimeError::test_runtime_error_can_be_raised PASSED [ 33%]
neuromanifold_gpt/tests/test_errors.py::TestErrorFormatting::test_error_message_contains_rich_formatting PASSED [ 33%]
neuromanifold_gpt/tests/test_errors.py::TestErrorFormatting::test_error_display_calls_console_print PASSED [ 33%]
neuromanifold_gpt/tests/test_errors.py::TestErrorFormatting::test_error_panel_has_correct_title PASSED [ 34%]
neuromanifold_gpt/tests/test_errors.py::TestErrorFormatting::test_all_error_types_format_consistently PASSED [ 34%]
neuromanifold_gpt/tests/test_errors.py::TestErrorUsagePatterns::test_config_validation_error_pattern PASSED [ 34%]
neuromanifold_gpt/tests/test_errors.py::TestErrorUsagePatterns::test_model_loading_error_pattern PASSED [ 34%]
neuromanifold_gpt/tests/test_errors.py::TestErrorUsagePatterns::test_argument_validation_error_pattern PASSED [ 34%]
neuromanifold_gpt/tests/test_errors.py::TestErrorUsagePatterns::test_feature_disabled_error_pattern PASSED [ 34%]
neuromanifold_gpt/tests/test_faster_kan.py::TestRSWAFBasis::test_output_shape PASSED [ 34%]
neuromanifold_gpt/tests/test_faster_kan.py::TestRSWAFBasis::test_output_range PASSED [ 35%]
neuromanifold_gpt/tests/test_faster_kan.py::TestRSWAFBasis::test_peak_at_center PASSED [ 35%]
neuromanifold_gpt/tests/test_faster_kan.py::TestRSWAFBasis::test_gradient_flow PASSED [ 35%]
neuromanifold_gpt/tests/test_faster_kan.py::TestRSWAFBasis::test_learnable_parameters PASSED [ 35%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANLayer::test_forward_shape PASSED [ 35%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANLayer::test_backward_pass PASSED [ 35%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANLayer::test_numerical_stability PASSED [ 36%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANLayer::test_no_base_weight PASSED [ 36%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANLayer::test_no_bias PASSED [ 36%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANLayer::test_different_centers[4] PASSED [ 36%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANLayer::test_different_centers[8] PASSED [ 36%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANLayer::test_different_centers[16] PASSED [ 36%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANFFN::test_forward_shape PASSED [ 36%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANFFN::test_backward_pass PASSED [ 37%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANFFN::test_dropout_behavior PASSED [ 37%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANFFN::test_residual_compatibility PASSED [ 37%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANFFN::test_numerical_stability PASSED [ 37%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANLinear::test_forward_shape PASSED [ 37%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANLinear::test_backward_pass PASSED [ 37%]
neuromanifold_gpt/tests/test_faster_kan.py::TestCausalityPreservation::test_position_independence PASSED [ 37%]
neuromanifold_gpt/tests/test_faster_kan.py::TestReplaceLinearWithFasterKAN::test_replace_linear PASSED [ 38%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANCUDA::test_cuda_forward PASSED [ 38%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANCUDA::test_cuda_backward PASSED [ 38%]
neuromanifold_gpt/tests/test_faster_kan.py::TestFasterKANCUDA::test_cuda_ffn PASSED [ 38%]
neuromanifold_gpt/tests/test_fhn.py::test_fhn_output_shape PASSED        [ 38%]
neuromanifold_gpt/tests/test_fhn.py::test_fhn_pulse_width_positive PASSED [ 38%]
neuromanifold_gpt/tests/test_fhn.py::test_fhn_threshold_behavior PASSED  [ 38%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_output_shapes_match FAILED [ 39%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_gradient_flow_old_path FAILED [ 39%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_gradient_flow_new_path FAILED [ 39%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_fhn_state_computed_both_paths FAILED [ 39%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_no_fhn_steps_matches_flash_attention FAILED [ 39%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_output_stats_computed_both_paths FAILED [ 39%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_various_sequence_lengths FAILED [ 39%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_various_batch_sizes FAILED [ 40%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_deterministic_with_fixed_seed FAILED [ 40%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_outputs_are_different_due_to_different_proxies FAILED [ 40%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_pulse_widths_positive_both_paths FAILED [ 40%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_backward_compatibility_flag_default FAILED [ 40%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_new_path_attn_probs_is_none FAILED [ 40%]
neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_old_path_attn_probs_exists FAILED [ 40%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeStateStatistics::test_state_statistics_keys PASSED [ 41%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeStateStatistics::test_state_statistics_constant_state PASSED [ 41%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeStateStatistics::test_state_statistics_bounded_values PASSED [ 41%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeStateStatistics::test_state_statistics_positive_std PASSED [ 41%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeStateStatistics::test_state_statistics_range_consistency PASSED [ 41%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputePulseWidthStatistics::test_pulse_width_statistics_keys PASSED [ 41%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputePulseWidthStatistics::test_pulse_width_statistics_constant_widths PASSED [ 41%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputePulseWidthStatistics::test_pulse_width_statistics_positive_values PASSED [ 42%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputePulseWidthStatistics::test_pulse_width_statistics_varying_widths PASSED [ 42%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputePulseWidthStatistics::test_pulse_width_statistics_base_value PASSED [ 42%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeWaveStability::test_wave_stability_keys PASSED [ 42%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeWaveStability::test_wave_stability_bounded_positive PASSED [ 42%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeWaveStability::test_wave_stability_bounded_negative PASSED [ 42%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeWaveStability::test_wave_stability_abs_mean_positive PASSED [ 43%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeWaveStability::test_wave_stability_abs_mean_zero_state PASSED [ 43%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeWaveStability::test_wave_stability_abs_mean_symmetric PASSED [ 43%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeWaveStability::test_wave_stability_boundary_exact PASSED [ 43%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeAll::test_compute_all_complete_info PASSED [ 43%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeAll::test_compute_all_state_only PASSED [ 43%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeAll::test_compute_all_pulse_widths_only PASSED [ 43%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeAll::test_compute_all_empty_info PASSED [ 44%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeAll::test_compute_all_scalar_tensors PASSED [ 44%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeAll::test_compute_all_realistic_values PASSED [ 44%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestEdgeCases::test_single_value_tensors PASSED [ 44%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestEdgeCases::test_large_tensors PASSED [ 44%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestEdgeCases::test_extreme_values PASSED [ 44%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestEdgeCases::test_numerical_stability PASSED [ 44%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestEdgeCases::test_none_values_in_info PASSED [ 45%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestEdgeCases::test_mixed_dimensions PASSED [ 45%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestIntegrationWithFHNAttention::test_typical_fhn_attention_output PASSED [ 45%]
neuromanifold_gpt/tests/test_fhn_metrics.py::TestIntegrationWithFHNAttention::test_multi_layer_aggregation PASSED [ 45%]
neuromanifold_gpt/tests/test_gpt.py::test_gpt_forward PASSED             [ 45%]
neuromanifold_gpt/tests/test_gpt.py::test_gpt_with_targets PASSED        [ 45%]
neuromanifold_gpt/tests/test_gpt.py::test_gpt_generate PASSED            [ 45%]
neuromanifold_gpt/tests/test_gpt.py::test_gpt_info_dict PASSED           [ 46%]
neuromanifold_gpt/tests/test_gpt.py::test_gpt_memory_stores_during_training PASSED [ 46%]
neuromanifold_gpt/tests/test_gpt.py::test_gpt_no_memory_during_eval PASSED [ 46%]
neuromanifold_gpt/tests/test_gpt.py::test_gpt_memory_active_retrieval PASSED [ 46%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_store_retrieve FAILED [ 46%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_total_capacity FAILED [ 46%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_empty_retrieval FAILED [ 46%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_clear FAILED [ 47%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_get_stats FAILED [ 47%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_similarity_threshold FAILED [ 47%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_partial_overlap_retrieval FAILED [ 47%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_multiple_retrieval FAILED [ 47%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_correctness FAILED [ 47%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_performance FAILED [ 47%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_with_l1_overflow FAILED [ 48%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_with_l2_overflow FAILED [ 48%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_empty FAILED [ 48%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_single_item FAILED [ 48%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_equivalence FAILED [ 48%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_tier_promotion_l1_to_l2 FAILED [ 48%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_tier_promotion_l2_to_l3 FAILED [ 48%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_tier_promotion_cascade FAILED [ 49%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_capacity_l1_limit FAILED [ 49%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_capacity_l2_limit FAILED [ 49%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_capacity_l3_limit FAILED [ 49%]
neuromanifold_gpt/tests/test_hierarchical_engram.py::test_capacity_total_limit FAILED [ 49%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_store_retrieve_l1 FAILED [ 49%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_tier_stats FAILED [ 50%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_l1_to_l2_demotion FAILED [ 50%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_l2_to_l3_demotion FAILED [ 50%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_l2_to_l1_promotion FAILED [ 50%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_l3_to_l1_promotion FAILED [ 50%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_retrieval_across_tiers FAILED [ 50%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_similarity_threshold FAILED [ 50%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_clear FAILED [ 51%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_empty_retrieval FAILED [ 51%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_top_k_limit FAILED [ 51%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_capacity_enforcement FAILED [ 51%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_partial_overlap_retrieval FAILED [ 51%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_multiple_retrieval_sorted FAILED [ 51%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_device_movement FAILED [ 51%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_access_count_tracking FAILED [ 52%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_tier_override_threshold FAILED [ 52%]
neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_len_method FAILED [ 52%]
neuromanifold_gpt/tests/test_imagination.py::TestImaginationOutputShapes::test_imagination_output_shape_no_goal FAILED [ 52%]
neuromanifold_gpt/tests/test_imagination.py::TestImaginationOutputShapes::test_imagination_output_shape_with_goal FAILED [ 52%]
neuromanifold_gpt/tests/test_imagination.py::TestImaginationOutputShapes::test_imagination_various_n_alternatives FAILED [ 52%]
neuromanifold_gpt/tests/test_imagination.py::TestImaginationOutputShapes::test_imagination_single_token FAILED [ 52%]
neuromanifold_gpt/tests/test_imagination.py::TestImaginationOutputShapes::test_imagination_various_embed_dims FAILED [ 53%]
neuromanifold_gpt/tests/test_imagination.py::TestImaginationSteps::test_imagination_two_steps FAILED [ 53%]
neuromanifold_gpt/tests/test_imagination.py::TestImaginationSteps::test_imagination_four_steps FAILED [ 53%]
neuromanifold_gpt/tests/test_imagination.py::TestImaginationSteps::test_noise_schedule_properties FAILED [ 53%]
neuromanifold_gpt/tests/test_imagination.py::TestGoalConditioning::test_goal_conditioning_affects_output FAILED [ 53%]
neuromanifold_gpt/tests/test_imagination.py::TestGoalConditioning::test_goal_affects_scores FAILED [ 53%]
neuromanifold_gpt/tests/test_imagination.py::TestScoreProperties::test_scores_finite FAILED [ 53%]
neuromanifold_gpt/tests/test_imagination.py::TestScoreProperties::test_best_matches_highest_score FAILED [ 54%]
neuromanifold_gpt/tests/test_imagination.py::TestScoreProperties::test_scores_vary_across_alternatives FAILED [ 54%]
neuromanifold_gpt/tests/test_imagination.py::TestGradientFlow::test_gradient_through_alternatives FAILED [ 54%]
neuromanifold_gpt/tests/test_imagination.py::TestGradientFlow::test_gradient_through_scores FAILED [ 54%]
neuromanifold_gpt/tests/test_imagination.py::TestGradientFlow::test_gradient_through_best FAILED [ 54%]
neuromanifold_gpt/tests/test_imagination.py::TestGradientFlow::test_gradient_with_goal FAILED [ 54%]
neuromanifold_gpt/tests/test_imagination.py::TestDeterminism::test_eval_mode_deterministic_with_seed FAILED [ 54%]
neuromanifold_gpt/tests/test_imagination.py::TestDeterminism::test_different_seeds_produce_different_results FAILED [ 55%]
neuromanifold_gpt/tests/test_imagination.py::TestDropout::test_dropout_training_mode FAILED [ 55%]
neuromanifold_gpt/tests/test_imagination.py::TestDropout::test_dropout_eval_mode FAILED [ 55%]
neuromanifold_gpt/tests/test_imagination.py::TestBatchSizeVariations::test_single_batch FAILED [ 55%]
neuromanifold_gpt/tests/test_imagination.py::TestBatchSizeVariations::test_large_batch FAILED [ 55%]
neuromanifold_gpt/tests/test_imagination.py::TestInternalComponents::test_denoiser_output_shape FAILED [ 55%]
neuromanifold_gpt/tests/test_imagination.py::TestInternalComponents::test_goal_encoder_output_shape FAILED [ 55%]
neuromanifold_gpt/tests/test_imagination.py::TestInternalComponents::test_scorer_output_shape FAILED [ 56%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_creation PASSED [ 56%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_info_method PASSED [ 56%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_warning_method PASSED [ 56%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_error_method PASSED [ 56%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_debug_method PASSED [ 56%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_metric_method PASSED [ 56%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_metric_formatting PASSED [ 57%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_metric_integer_value PASSED [ 57%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_progress_method PASSED [ 57%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_progress_percentage_calculation PASSED [ 57%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_progress_zero_total PASSED [ 57%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_section_method PASSED [ 57%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_bind_method PASSED [ 58%]
neuromanifold_gpt/tests/test_logging.py::TestRichLogger::test_logger_with_kwargs PASSED [ 58%]
neuromanifold_gpt/tests/test_logging.py::TestGetLogger::test_get_logger_returns_rich_logger PASSED [ 58%]
neuromanifold_gpt/tests/test_logging.py::TestGetLogger::test_get_logger_sets_name PASSED [ 58%]
neuromanifold_gpt/tests/test_logging.py::TestGetLogger::test_get_logger_multiple_instances PASSED [ 58%]
neuromanifold_gpt/tests/test_logging.py::TestConfigureLogging::test_configure_logging_default PASSED [ 58%]
neuromanifold_gpt/tests/test_logging.py::TestConfigureLogging::test_configure_logging_custom_level PASSED [ 58%]
neuromanifold_gpt/tests/test_logging.py::TestConfigureLogging::test_configure_logging_custom_format PASSED [ 59%]
neuromanifold_gpt/tests/test_logging.py::TestConfigureLogging::test_configure_logging_custom_theme PASSED [ 59%]
neuromanifold_gpt/tests/test_logging.py::TestConfigureLogging::test_configure_logging_env_var_level PASSED [ 59%]
neuromanifold_gpt/tests/test_logging.py::TestConfigureLogging::test_configure_logging_env_var_format PASSED [ 59%]
neuromanifold_gpt/tests/test_logging.py::TestConfigureLogging::test_configure_logging_parameter_overrides_env PASSED [ 59%]
neuromanifold_gpt/tests/test_logging.py::TestLoggingIntegration::test_logger_workflow PASSED [ 59%]
neuromanifold_gpt/tests/test_logging.py::TestLoggingIntegration::test_logger_with_context PASSED [ 59%]
neuromanifold_gpt/tests/test_logging.py::TestLoggingIntegration::test_multiple_loggers_coexist PASSED [ 60%]
neuromanifold_gpt/tests/test_logging.py::TestLoggingIntegration::test_configure_multiple_times PASSED [ 60%]
neuromanifold_gpt/tests/test_logging.py::TestLoggingEdgeCases::test_logger_empty_name PASSED [ 60%]
neuromanifold_gpt/tests/test_logging.py::TestLoggingEdgeCases::test_logger_special_characters_in_name PASSED [ 60%]
neuromanifold_gpt/tests/test_logging.py::TestLoggingEdgeCases::test_metric_with_empty_unit PASSED [ 60%]
neuromanifold_gpt/tests/test_logging.py::TestLoggingEdgeCases::test_progress_with_negative_values PASSED [ 60%]
neuromanifold_gpt/tests/test_logging.py::TestLoggingEdgeCases::test_progress_current_exceeds_total PASSED [ 60%]
neuromanifold_gpt/tests/test_logging.py::TestLoggingEdgeCases::test_section_with_unicode PASSED [ 61%]
neuromanifold_gpt/tests/test_logging.py::TestLoggingEdgeCases::test_message_with_unicode PASSED [ 61%]
neuromanifold_gpt/tests/test_manifold.py::TestManifoldProjectionShape::test_manifold_projection_shape PASSED [ 61%]
neuromanifold_gpt/tests/test_manifold.py::TestManifoldProjectionShape::test_manifold_projection_single_token PASSED [ 61%]
neuromanifold_gpt/tests/test_manifold.py::TestManifoldProjectionShape::test_manifold_projection_various_dims PASSED [ 61%]
neuromanifold_gpt/tests/test_manifold.py::TestMetricTensor::test_metric_positive_definite PASSED [ 61%]
neuromanifold_gpt/tests/test_manifold.py::TestMetricTensor::test_metric_positive_definite_various_inputs PASSED [ 61%]
neuromanifold_gpt/tests/test_manifold.py::TestMetricTensor::test_metric_symmetric PASSED [ 62%]
neuromanifold_gpt/tests/test_manifold.py::TestGeodesicDistance::test_geodesic_distance_symmetric PASSED [ 62%]
neuromanifold_gpt/tests/test_manifold.py::TestGeodesicDistance::test_geodesic_distance_zero_diagonal PASSED [ 62%]
neuromanifold_gpt/tests/test_manifold.py::TestGeodesicDistance::test_geodesic_distance_non_negative PASSED [ 62%]
neuromanifold_gpt/tests/test_manifold.py::TestGeodesicDistance::test_geodesic_distance_shape PASSED [ 62%]
neuromanifold_gpt/tests/test_manifold.py::TestGradientFlow::test_gradient_through_coords PASSED [ 62%]
neuromanifold_gpt/tests/test_manifold.py::TestGradientFlow::test_gradient_through_metric FAILED [ 62%]
neuromanifold_gpt/tests/test_manifold.py::TestGradientFlow::test_gradient_through_distance PASSED [ 63%]
neuromanifold_gpt/tests/test_manifold.py::TestDeterminism::test_eval_mode_deterministic PASSED [ 63%]
neuromanifold_gpt/tests/test_manifold.py::TestCustomHiddenDim::test_custom_hidden_dim PASSED [ 63%]
neuromanifold_gpt/tests/test_manifold.py::TestCustomHiddenDim::test_default_hidden_dim PASSED [ 63%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPComputeAccuracy::test_accuracy_perfect_predictions PASSED [ 63%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPComputeAccuracy::test_accuracy_zero_predictions PASSED [ 63%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPComputeAccuracy::test_accuracy_partial_correct PASSED [ 63%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPComputeAccuracy::test_accuracy_top_k PASSED [ 64%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPTopKAccuracies::test_top_k_accuracies_keys PASSED [ 64%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPTopKAccuracies::test_top_k_accuracies_increasing PASSED [ 64%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPTopKAccuracies::test_top_k_accuracies_exceeds_vocab PASSED [ 64%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPConfidenceStatistics::test_confidence_statistics_keys PASSED [ 64%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPConfidenceStatistics::test_confidence_high_certainty PASSED [ 64%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPConfidenceStatistics::test_confidence_uniform_distribution PASSED [ 65%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPConfidenceStatistics::test_confidence_bounds PASSED [ 65%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPPerDepthAccuracy::test_per_depth_single_depth PASSED [ 65%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPPerDepthAccuracy::test_per_depth_multiple_depths PASSED [ 65%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPPerDepthAccuracy::test_per_depth_custom_labels PASSED [ 65%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPPerDepthAccuracy::test_per_depth_target_alignment PASSED [ 65%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPComputeAll::test_compute_all_keys PASSED [ 65%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMTPComputeAll::test_compute_all_consistency PASSED [ 66%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryCapacityStatistics::test_capacity_statistics_basic PASSED [ 66%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryCapacityStatistics::test_capacity_statistics_full PASSED [ 66%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryCapacityStatistics::test_capacity_statistics_empty PASSED [ 66%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryCapacityStatistics::test_capacity_statistics_tensor_inputs PASSED [ 66%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryCapacityStatistics::test_capacity_statistics_dimensions PASSED [ 66%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryLayerStatistics::test_layer_statistics_two_layers PASSED [ 66%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryLayerStatistics::test_layer_statistics_single_layer PASSED [ 67%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryLayerStatistics::test_layer_statistics_multiple_layers PASSED [ 67%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryLayerStatistics::test_layer_statistics_tensor_inputs PASSED [ 67%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryRetrievalStatistics::test_retrieval_statistics_basic PASSED [ 67%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryRetrievalStatistics::test_retrieval_statistics_partial PASSED [ 67%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryRetrievalStatistics::test_retrieval_statistics_tensor_inputs PASSED [ 67%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryComputeAll::test_compute_all_comprehensive PASSED [ 67%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryComputeAll::test_compute_all_total_size_alias PASSED [ 68%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestMemoryComputeAll::test_compute_all_empty_stats PASSED [ 68%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestIntegrationPatterns::test_mtp_with_model_info_pattern PASSED [ 68%]
neuromanifold_gpt/tests/test_mtp_memory_metrics.py::TestIntegrationPatterns::test_memory_with_engram_pattern PASSED [ 68%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_learned_pos_emb_forward FAILED [ 68%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_ramanujan_pos_emb_forward FAILED [ 68%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_rotary_pos_emb_forward FAILED [ 68%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_alibi_pos_emb_forward FAILED [ 69%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_targets[learned] FAILED [ 69%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_targets[ramanujan] FAILED [ 69%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_targets[rotary] FAILED [ 69%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_targets[alibi] FAILED [ 69%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_generate[learned] FAILED [ 69%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_generate[ramanujan] FAILED [ 69%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_generate[rotary] FAILED [ 70%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_generate[alibi] FAILED [ 70%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_produce_different_outputs[learned] FAILED [ 70%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_produce_different_outputs[ramanujan] FAILED [ 70%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_produce_different_outputs[rotary] FAILED [ 70%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_produce_different_outputs[alibi] FAILED [ 70%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_info_dict[learned] FAILED [ 70%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_info_dict[ramanujan] FAILED [ 71%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_info_dict[rotary] FAILED [ 71%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_info_dict[alibi] FAILED [ 71%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_learned_vs_ramanujan_different_positions FAILED [ 71%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_rotary_vs_alibi_different_mechanisms FAILED [ 71%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_gradient_flow[learned] FAILED [ 71%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_gradient_flow[ramanujan] FAILED [ 72%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_gradient_flow[rotary] FAILED [ 72%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_gradient_flow[alibi] FAILED [ 72%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_batch_size_independence[learned] FAILED [ 72%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_batch_size_independence[ramanujan] FAILED [ 72%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_batch_size_independence[rotary] FAILED [ 72%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_batch_size_independence[alibi] FAILED [ 72%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_sequence_length_independence[learned] FAILED [ 73%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_sequence_length_independence[ramanujan] FAILED [ 73%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_sequence_length_independence[rotary] FAILED [ 73%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_sequence_length_independence[alibi] FAILED [ 73%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_learned_pos_emb_initialization FAILED [ 73%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_ramanujan_pos_emb_initialization FAILED [ 73%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_rotary_pos_emb_initialization FAILED [ 73%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_alibi_pos_emb_initialization FAILED [ 74%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_invalid_pos_emb_type FAILED [ 74%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_deterministic[learned] FAILED [ 74%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_deterministic[ramanujan] FAILED [ 74%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_deterministic[rotary] FAILED [ 74%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_deterministic[alibi] FAILED [ 74%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_memory_efficiency[learned] FAILED [ 74%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_memory_efficiency[ramanujan] FAILED [ 75%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_memory_efficiency[rotary] FAILED [ 75%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_memory_efficiency[alibi] FAILED [ 75%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_rotary_extrapolation_capability FAILED [ 75%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_alibi_extrapolation_capability FAILED [ 75%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_sdr[learned] FAILED [ 75%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_sdr[ramanujan] FAILED [ 75%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_sdr[rotary] FAILED [ 76%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_sdr[alibi] FAILED [ 76%]
neuromanifold_gpt/tests/test_position_embeddings.py::test_pos_emb_type_saved_in_config FAILED [ 76%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_initialization PASSED  [ 76%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_odd_head_dim_raises PASSED [ 76%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_forward_shape_preservation PASSED [ 76%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_different_batch_sizes PASSED [ 76%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_cache_extension PASSED [ 77%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_rotation_correctness PASSED [ 77%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_rotation_preserves_magnitude PASSED [ 77%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_relative_position_encoding PASSED [ 77%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_single_token PASSED    [ 77%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_different_head_dims PASSED [ 77%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_frequency_scaling PASSED [ 77%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_cos_sin_cache PASSED   [ 78%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_position_zero_minimal_rotation PASSED [ 78%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_deterministic PASSED   [ 78%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_rotate_half PASSED     [ 78%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_no_gradient_through_cache PASSED [ 78%]
neuromanifold_gpt/tests/test_rotary.py::test_rope_gradient_flow PASSED   [ 78%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeSparsity::test_sparsity_exact_2_percent PASSED [ 79%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeSparsity::test_sparsity_empty_sdr PASSED [ 79%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeSparsity::test_sparsity_full_sdr PASSED [ 79%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeSparsity::test_sparsity_batched PASSED [ 79%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeSparsity::test_sparsity_varying_activation PASSED [ 79%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeEntropy::test_entropy_uniform_distribution PASSED [ 79%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeEntropy::test_entropy_empty_sdr PASSED [ 79%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeEntropy::test_entropy_single_bit PASSED [ 80%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeEntropy::test_entropy_batched PASSED [ 80%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeEntropy::test_entropy_normalization PASSED [ 80%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeOverlapStatistics::test_overlap_identical_sdrs PASSED [ 80%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeOverlapStatistics::test_overlap_disjoint_sdrs PASSED [ 80%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeOverlapStatistics::test_overlap_partial PASSED [ 80%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeOverlapStatistics::test_overlap_single_sdr PASSED [ 80%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeOverlapStatistics::test_overlap_multiple_pairs PASSED [ 81%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeOverlapStatistics::test_overlap_batch_and_sequence PASSED [ 81%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeAll::test_compute_all_structure PASSED [ 81%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeAll::test_compute_all_uniform_sdrs PASSED [ 81%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeAll::test_compute_all_varying_sdrs PASSED [ 81%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeAll::test_compute_all_empty_batch PASSED [ 81%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeAll::test_compute_all_realistic_batch PASSED [ 81%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestEdgeCases::test_single_dimension_tensor PASSED [ 82%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestEdgeCases::test_high_dimensional_tensor PASSED [ 82%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestEdgeCases::test_different_sdr_dimensions PASSED [ 82%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestEdgeCases::test_numerical_stability_entropy PASSED [ 82%]
neuromanifold_gpt/tests/test_sdr_metrics.py::TestEdgeCases::test_overlap_with_empty_sdr PASSED [ 82%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestHardTopK::test_hard_topk_sparsity PASSED [ 82%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestHardTopK::test_hard_topk_single_tensor PASSED [ 82%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestHardTopK::test_hard_topk_deterministic PASSED [ 83%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestOverlapCount::test_overlap_count PASSED [ 83%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestOverlapCount::test_overlap_count_no_overlap PASSED [ 83%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestOverlapCount::test_overlap_count_full_overlap PASSED [ 83%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestOverlapCount::test_overlap_count_batched PASSED [ 83%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestUnion::test_union PASSED    [ 83%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestUnion::test_union_clamping PASSED [ 83%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestUnion::test_union_empty PASSED [ 84%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestIntersection::test_intersection PASSED [ 84%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestIntersection::test_intersection_disjoint PASSED [ 84%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestSemanticSimilarity::test_semantic_similarity_identical PASSED [ 84%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestSemanticSimilarity::test_semantic_similarity_disjoint PASSED [ 84%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestSemanticSimilarity::test_semantic_similarity_half PASSED [ 84%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestSparsity::test_sparsity PASSED [ 84%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestSparsity::test_sparsity_target PASSED [ 85%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestSoftTopK::test_soft_topk_gradient_flow PASSED [ 85%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestSoftTopK::test_soft_topk_same_sparsity PASSED [ 85%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestDtypeSupport::test_hard_topk_dtype[dtype0] PASSED [ 85%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestDtypeSupport::test_hard_topk_dtype[dtype1] PASSED [ 85%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestDtypeSupport::test_overlap_count_dtype[dtype0] PASSED [ 85%]
neuromanifold_gpt/tests/test_sdr_ops.py::TestDtypeSupport::test_overlap_count_dtype[dtype1] PASSED [ 86%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderOutputShape::test_encoder_output_shape FAILED [ 86%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderOutputShape::test_encoder_single_token FAILED [ 86%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderOutputShape::test_encoder_batch_sizes FAILED [ 86%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderSparsity::test_encoder_sparsity FAILED [ 86%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderSparsity::test_encoder_binary_values FAILED [ 86%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderSparsity::test_training_mode_sparsity FAILED [ 86%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestSemanticSimilarity::test_semantic_similarity_self FAILED [ 87%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestSemanticSimilarity::test_semantic_similarity_different_tokens FAILED [ 87%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestPhraseEncoding::test_encode_phrase FAILED [ 87%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestPhraseEncoding::test_encode_phrase_batched FAILED [ 87%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestGradientFlow::test_gradient_through_encoder FAILED [ 87%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestGradientFlow::test_gradient_through_sdr FAILED [ 87%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestDeterminism::test_eval_mode_deterministic FAILED [ 87%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderComponents::test_context_encoder_integration FAILED [ 88%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderComponents::test_retina_integration PASSED [ 88%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestBoostingMechanism::test_boosting_updates_duty_cycle FAILED [ 88%]
neuromanifold_gpt/tests/test_semantic_folding.py::TestBoostingMechanism::test_boosting_disabled_in_eval FAILED [ 88%]
neuromanifold_gpt/tests/test_semantic_retina.py::TestSemanticRetina::test_retina_output_shape PASSED [ 88%]
neuromanifold_gpt/tests/test_semantic_retina.py::TestSemanticRetina::test_retina_smoothing PASSED [ 88%]
neuromanifold_gpt/tests/test_semantic_retina.py::TestSemanticRetina::test_gaussian_kernel_normalized PASSED [ 88%]
neuromanifold_gpt/tests/test_semantic_retina.py::TestSemanticRetina::test_retina_different_grid_sizes PASSED [ 89%]
neuromanifold_gpt/tests/test_semantic_retina.py::TestSemanticRetina::test_retina_kernel_size_affects_spread PASSED [ 89%]
neuromanifold_gpt/tests/test_semantic_retina.py::TestSemanticRetina::test_retina_batch_independence PASSED [ 89%]
neuromanifold_gpt/tests/test_semantic_retina.py::TestSemanticRetina::test_retina_gradient_flow PASSED [ 89%]
neuromanifold_gpt/tests/test_spectral.py::test_spectral_output_shapes PASSED [ 89%]
neuromanifold_gpt/tests/test_spectral.py::test_spectral_basis_normalized FAILED [ 89%]
neuromanifold_gpt/tests/test_spectral.py::test_spectral_frequencies_positive PASSED [ 89%]
neuromanifold_gpt/tests/test_spectral.py::test_ortho_regularization PASSED [ 90%]
neuromanifold_gpt/tests/test_spectral.py::test_spectral_gradient_flow PASSED [ 90%]
neuromanifold_gpt/tests/test_spectral.py::test_random_features_mode PASSED [ 90%]
neuromanifold_gpt/tests/test_spectral.py::TestFastSpectralAttention::test_output_shape PASSED [ 90%]
neuromanifold_gpt/tests/test_spectral.py::TestFastSpectralAttention::test_gradient_flow PASSED [ 90%]
neuromanifold_gpt/tests/test_spectral.py::TestFastSpectralAttention::test_numerical_stability PASSED [ 90%]
neuromanifold_gpt/tests/test_spectral_chunked.py::TestChunkedSpectralAttention::test_numerical_equivalence_chunk64 PASSED [ 90%]
neuromanifold_gpt/tests/test_spectral_chunked.py::TestChunkedSpectralAttention::test_numerical_equivalence_chunk128 PASSED [ 91%]
neuromanifold_gpt/tests/test_spectral_chunked.py::TestChunkedSpectralAttention::test_numerical_equivalence_chunk256 PASSED [ 91%]
neuromanifold_gpt/tests/test_spectral_chunked.py::TestChunkedSpectralAttention::test_edge_case_t_not_divisible_63 PASSED [ 91%]
neuromanifold_gpt/tests/test_spectral_chunked.py::TestChunkedSpectralAttention::test_edge_case_t_not_divisible_257 PASSED [ 91%]
neuromanifold_gpt/tests/test_spectral_chunked.py::TestChunkedSpectralAttention::test_edge_case_single_timestep PASSED [ 91%]
neuromanifold_gpt/tests/test_spectral_chunked.py::TestChunkedSpectralAttention::test_causality_preserved PASSED [ 91%]
neuromanifold_gpt/tests/test_spectral_chunked.py::TestChunkedSpectralAttention::test_full_forward_pass_equivalence PASSED [ 91%]
neuromanifold_gpt/tests/test_spectral_chunked.py::TestChunkedSpectralAttention::test_gradient_flow_chunked PASSED [ 92%]
neuromanifold_gpt/tests/test_spectral_chunked.py::TestChunkedSpectralAttention::test_output_shapes_chunked PASSED [ 92%]
neuromanifold_gpt/tests/test_spectral_chunked.py::TestChunkedSpectralAttention::test_memory_usage FAILED [ 92%]
neuromanifold_gpt/tests/test_topographic_loss.py::test_topographic_loss_basic FAILED [ 92%]
neuromanifold_gpt/tests/test_topographic_loss.py::test_topographic_loss_gradient FAILED [ 92%]
neuromanifold_gpt/tests/test_topographic_loss.py::test_topographic_loss_inference FAILED [ 92%]
neuromanifold_gpt/tests/test_topographic_loss.py::test_full_model_integration PASSED [ 93%]
neuromanifold_gpt/tests/test_train.py::test_lightning_module_init FAILED [ 93%]
neuromanifold_gpt/tests/test_train.py::test_training_step FAILED         [ 93%]
neuromanifold_gpt/tests/test_train.py::test_configure_optimizers FAILED  [ 93%]
neuromanifold_gpt/tests/test_train.py::test_validation_step FAILED       [ 93%]
neuromanifold_gpt/tests/test_train.py::test_optimizer_has_weight_decay_groups FAILED [ 93%]
neuromanifold_gpt/tests/test_train.py::test_scheduler_is_cosine FAILED   [ 93%]
neuromanifold_gpt/tests/test_train.py::test_training_step_logs_metrics FAILED [ 94%]
neuromanifold_gpt/tests/test_train.py::test_config_has_training_params PASSED [ 94%]
neuromanifold_gpt/tests/test_train.py::test_train_smoke FAILED           [ 94%]
neuromanifold_gpt/tests/test_train.py::TestCosineWarmupLR::test_lr_at_zero_is_small PASSED [ 94%]
neuromanifold_gpt/tests/test_train.py::TestCosineWarmupLR::test_lr_at_warmup_end PASSED [ 94%]
neuromanifold_gpt/tests/test_train.py::TestCosineWarmupLR::test_lr_after_decay PASSED [ 94%]
neuromanifold_gpt/tests/test_train.py::TestCosineWarmupLR::test_lr_monotonically_increases_during_warmup PASSED [ 94%]
neuromanifold_gpt/tests/test_train.py::TestGPTConfigureOptimizers::test_gpt_configure_optimizers PASSED [ 95%]
neuromanifold_gpt/tests/test_train.py::TestGPTConfigureOptimizers::test_gpt_optimizer_has_two_groups PASSED [ 95%]
neuromanifold_gpt/tests/test_train.py::TestGPTConfigureOptimizers::test_num_parameters FAILED [ 95%]
neuromanifold_gpt/tests/test_train.py::TestNanoGPTTrainingLoop::test_model_forward_returns_info_dict PASSED [ 95%]
neuromanifold_gpt/tests/test_train.py::TestNanoGPTTrainingLoop::test_model_gradient_flow PASSED [ 95%]
neuromanifold_gpt/tests/test_train.py::TestNanoGPTTrainingLoop::test_model_mixed_precision FAILED [ 95%]
neuromanifold_gpt/tests/test_train.py::TestNanoGPTTrainingLoop::test_gradient_accumulation_simulation PASSED [ 95%]
neuromanifold_gpt/tests/test_train.py::TestCheckpointing::test_checkpoint_roundtrip PASSED [ 96%]
neuromanifold_gpt/tests/test_training_modules.py::test_train_config_initialization FAILED [ 96%]
neuromanifold_gpt/tests/test_training_modules.py::test_train_config_custom_values PASSED [ 96%]
neuromanifold_gpt/tests/test_training_modules.py::test_memmap_dataset_initialization FAILED [ 96%]
neuromanifold_gpt/tests/test_training_modules.py::test_text_data_module_initialization FAILED [ 96%]
neuromanifold_gpt/tests/test_training_modules.py::test_text_data_module_setup FAILED [ 96%]
neuromanifold_gpt/tests/test_training_modules.py::test_streaming_data_module_initialization FAILED [ 96%]
neuromanifold_gpt/tests/test_training_modules.py::test_lightning_module_initialization FAILED [ 97%]
neuromanifold_gpt/tests/test_training_modules.py::test_lightning_module_training_step FAILED [ 97%]
neuromanifold_gpt/tests/test_training_modules.py::test_lightning_module_validation_step FAILED [ 97%]
neuromanifold_gpt/tests/test_training_modules.py::test_lightning_module_configure_optimizers FAILED [ 97%]
neuromanifold_gpt/tests/test_training_modules.py::test_sample_generation_callback_initialization FAILED [ 97%]
neuromanifold_gpt/tests/test_training_modules.py::test_mfu_callback_initialization FAILED [ 97%]
neuromanifold_gpt/tests/test_training_modules.py::test_integration_imports FAILED [ 97%]
neuromanifold_gpt/tests/test_training_modules.py::test_integration_data_to_module FAILED [ 98%]
neuromanifold_gpt/tests/test_training_modules.py::test_integration_config_to_module FAILED [ 98%]
neuromanifold_gpt/tests/test_training_modules.py::test_callbacks_work_with_lightning_module FAILED [ 98%]
neuromanifold_gpt/tests/test_training_modules.py::test_lightning_module_logs_metrics FAILED [ 98%]
neuromanifold_gpt/tests/test_training_modules.py::test_module_has_all_config_attributes FAILED [ 98%]
neuromanifold_gpt/tests/test_vectorized_retrieval.py::test_retrieve_batch_vs_sequential_equivalence PASSED [ 98%]
neuromanifold_gpt/tests/test_vectorized_retrieval.py::test_large_batch_vectorized_retrieval PASSED [ 98%]
neuromanifold_gpt/tests/test_vectorized_retrieval.py::test_retrieval_threshold_filtering PASSED [ 99%]
neuromanifold_gpt/tests/test_wave_kan.py::TestWaveKAN::test_backward_pass PASSED [ 99%]
neuromanifold_gpt/tests/test_wave_kan.py::TestWaveKAN::test_causality PASSED [ 99%]
neuromanifold_gpt/tests/test_wave_kan.py::TestWaveKAN::test_numerical_stability PASSED [ 99%]
neuromanifold_gpt/tests/test_wave_kan.py::TestWaveKAN::test_wavekan_ffn_shapes PASSED [ 99%]
neuromanifold_gpt/tests/test_wave_kan.py::TestWaveKAN::test_wavekan_linear_shapes PASSED [ 99%]
neuromanifold_gpt/tests/test_wave_kan.py::TestWaveKAN::test_wavelet_types PASSED [100%]

=================================== FAILURES ===================================
________ TestNeuroManifoldConfig.test_config_n_embd_divisible_by_heads _________

self = <neuromanifold_gpt.tests.test_config.TestNeuroManifoldConfig object at 0x7facbdb079b0>

    def test_config_n_embd_divisible_by_heads(self):
        """Test that n_embd must be divisible by n_heads."""
        from neuromanifold_gpt.config.base import NeuroManifoldConfig
        from neuromanifold_gpt.errors import ConfigurationError
    
        with pytest.raises(ConfigurationError):
>           NeuroManifoldConfig(n_embd=100, n_heads=8)  # 100 % 8 != 0

neuromanifold_gpt/tests/test_config.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
<string>:103: in __init__
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = NeuroManifoldConfig(vocab_size=50304, block_size=1024, use_sdr=False, sdr_size=2048, sdr_sparsity=0.02, sdr_n_active=4...e='wsd', warmup_ratio=0.05, stable_ratio=0.65, decay_ratio=0.3, label_smoothing=0.0, lm_head_fp32=True, init_std=0.006)

    def __post_init__(self) -> None:
        """Validate configuration and compute derived values."""
        # Fast mode enables all fast-path optimizations
        if self.fast_mode:
            self.skip_context_encoder = True
            self.skip_semantic_retina = True
            self.skip_metric_tensor = True
            self.n_fhn_steps = 1  # Reduce FHN steps
            self.sdr_size = min(self.sdr_size, 512)  # Cap SDR size
    
        # Compute number of active SDR bits
        self.sdr_n_active = int(self.sdr_size * self.sdr_sparsity)
    
        # Validate n_embd is divisible by n_heads
>       assert self.n_embd % self.n_heads == 0, (
            f"n_embd ({self.n_embd}) must be divisible by n_heads ({self.n_heads})"
        )
E       AssertionError: n_embd (100) must be divisible by n_heads (8)

neuromanifold_gpt/config/base.py:267: AssertionError
___________________ TestContextEncoderMask.test_mask_caching ___________________

self = <neuromanifold_gpt.tests.test_context_encoder.TestContextEncoderMask object at 0x7facbd9352e0>

    def test_mask_caching(self):
        """Mask should be cached for same sequence length."""
        from neuromanifold_gpt.model.context_encoder import ContextEncoder
    
        encoder = ContextEncoder(embed_dim=64, context_size=2)
        mask1 = encoder._make_local_mask(5, torch.device('cpu'))
        mask2 = encoder._make_local_mask(5, torch.device('cpu'))
    
        # Should use cached version
>       assert encoder._cached_seq_len == 5
E       assert 0 == 5
E        +  where 0 = ContextEncoder(\n  embed_dim=64, context_size=2, n_heads=4, dropout=0.0, use_layer_norm=True\n  (ln): LayerNorm((64,), eps=1e-05, elementwise_affine=True)\n  (context_proj): Linear(in_features=64, out_features=64, bias=True)\n  (context_attn): MultiheadAttention(\n    (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)\n  )\n  (context_gate): Sequential(\n    (0): Linear(in_features=128, out_features=64, bias=True)\n    (1): Identity()\n    (2): Sigmoid()\n  )\n)._cached_seq_len

neuromanifold_gpt/tests/test_context_encoder.py:110: AssertionError
______________ TestContextEncoderValidation.test_invalid_n_heads _______________

self = <neuromanifold_gpt.tests.test_context_encoder.TestContextEncoderValidation object at 0x7facbd936570>

    def test_invalid_n_heads(self):
        """Should raise error if embed_dim not divisible by n_heads."""
        from neuromanifold_gpt.model.context_encoder import ContextEncoder
    
        with pytest.raises(ValueError, match="must be divisible"):
>           ContextEncoder(embed_dim=100, n_heads=7)  # 100 not divisible by 7

neuromanifold_gpt/tests/test_context_encoder.py:277: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <[AttributeError("'ContextEncoder' object has no attribute 'embed_dim'") raised in repr()] ContextEncoder object at 0x7fac87783c80>
embed_dim = 100, context_size = 5, n_heads = 7, dropout = 0.0
use_layer_norm = True

    def __init__(
        self,
        embed_dim: int,
        context_size: int = 5,
        n_heads: int = 4,
        dropout: float = 0.0,
        use_layer_norm: bool = True,
    ) -> None:
        super().__init__()
    
        if embed_dim % n_heads != 0:
>           raise ConfigurationError(
                problem="embed_dim must be divisible by n_heads",
                cause=f"embed_dim={embed_dim} is not divisible by n_heads={n_heads}",
                recovery=f"Set embed_dim to a multiple of {n_heads} (e.g., embed_dim={n_heads * (embed_dim // n_heads + 1)})"
            )
E           neuromanifold_gpt.errors.ConfigurationError: embed_dim must be divisible by n_heads

neuromanifold_gpt/model/context_encoder.py:59: ConfigurationError
----------------------------- Captured stderr call -----------------------------
 ConfigurationError 
 Problem: embed_dim must be divisible by n_heads                  
                                                                  
 Cause: embed_dim=100 is not divisible by n_heads=7               
                                                                  
 Recovery: Set embed_dim to a multiple of 7 (e.g., embed_dim=105) 

________________________ test_dag_planner_forward_shape ________________________

    def test_dag_planner_forward_shape():
        """Planner should generate nodes, adjacency, and complexity estimates."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:10: TypeError
______________________ test_dag_planner_node_count_bounds ______________________

    def test_dag_planner_node_count_bounds():
        """Node count should respect min/max constraints."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:26: TypeError
______________________ test_dag_planner_acyclic_structure ______________________

    def test_dag_planner_acyclic_structure():
        """Adjacency matrix should be upper-triangular (DAG constraint)."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:43: TypeError
____________________ test_dag_planner_node_mask_consistency ____________________

    def test_dag_planner_node_mask_consistency():
        """Node mask should enable exactly node_count nodes."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:61: TypeError
_________________ test_dag_planner_adjacency_mask_application __________________

    def test_dag_planner_adjacency_mask_application():
        """Adjacency matrix should respect node mask."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:80: TypeError
_____________________ test_dag_planner_deterministic_mode ______________________

    def test_dag_planner_deterministic_mode():
        """Deterministic mode should produce consistent results."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:100: TypeError
_____________________ test_dag_planner_complexity_positive _____________________

    def test_dag_planner_complexity_positive():
        """Complexity scores should be positive."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:117: TypeError
_____________________ test_dag_planner_complexity_masking ______________________

    def test_dag_planner_complexity_masking():
        """Inactive nodes should have zero complexity."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:130: TypeError
__________________ test_dag_planner_surface_area_calculation ___________________

    def test_dag_planner_surface_area_calculation():
        """Surface area should be sum of active node complexities."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:146: TypeError
_______________________ test_dag_planner_execution_order _______________________

    def test_dag_planner_execution_order():
        """Execution order should follow topological sort."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=8, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:162: TypeError
____________ test_dag_planner_execution_order_respects_dependencies ____________

    def test_dag_planner_execution_order_respects_dependencies():
        """Execution order should respect dependency edges."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=8, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:187: TypeError
________________________ test_dag_planner_gradient_flow ________________________

    def test_dag_planner_gradient_flow():
        """Gradients should flow through planner."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:212: TypeError
_____________________ test_dag_planner_batch_independence ______________________

    def test_dag_planner_batch_independence():
        """Each batch item should be processed independently."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:227: TypeError
_______________________ test_dag_planner_empty_adjacency _______________________

    def test_dag_planner_empty_adjacency():
        """Planner should handle DAGs with no edges."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=8, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:246: TypeError
____________________ test_dag_planner_training_vs_eval_mode ____________________

    def test_dag_planner_training_vs_eval_mode():
        """Planner behavior should differ between training and eval modes."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:265: TypeError
_____________________ test_dag_planner_manifold_projection _____________________

    def test_dag_planner_manifold_projection():
        """Manifold projection should have correct dimensionality."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:289: TypeError
_________________ test_dag_planner_different_sequence_lengths __________________

    def test_dag_planner_different_sequence_lengths():
        """Planner should handle varying sequence lengths."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:303: TypeError
_______________________ test_dag_planner_device_movement _______________________

    def test_dag_planner_device_movement():
        """Planner should move to different devices."""
>       planner = ForcedDAGPlanner(
            embed_dim=384, manifold_dim=64, max_nodes=16, min_nodes=3
        )
E       TypeError: ForcedDAGPlanner.__init__() got an unexpected keyword argument 'manifold_dim'

neuromanifold_gpt/tests/test_dag_planner.py:321: TypeError
______________ TestEMANumericalStability.test_ema_alpha_boundary _______________

self = <neuromanifold_gpt.tests.test_ema.TestEMANumericalStability object at 0x7facbd8fe990>

    def test_ema_alpha_boundary(self):
        """Alpha near boundaries should work correctly."""
        x = torch.randn(2, 10, 8)
    
        # Alpha moderately high (0.95 is more realistic than 0.999)
        ema_high = DampedEMA(alpha=0.95)
        h_high = ema_high(x)
>       assert torch.allclose(h_high, 0.95 * x, rtol=1e-2)
E       assert False
E        +  where False = <built-in method allclose of type object at 0x7fada26068a0>(tensor([[[ 0.0836,  0.7876, -0.3236, -0.0272, -0.2695, -0.2429,  1.2014,\n           0.2362],\n         [-0.7933,  1.8381,  0.4146,  1.6536, -2.1780,  0.0478,  0.9214,\n           0.2526],\n         [-0.9692,  0.5260, -1.0398,  1.3673, -1.6351,  1.0268, -0.0698,\n          -0.3542],\n         [ 0.4386,  0.4651, -0.6371,  1.4327,  0.2897,  0.8326,  2.7471,\n           1.3130],\n         [ 0.6379,  1.1784,  0.9387,  0.4967,  0.1291,  1.3865, -1.4966,\n           0.1547],\n         [ 1.0629,  0.5926,  0.4816,  0.6109,  0.2181, -0.2576,  1.7931,\n          -1.7982],\n         [-1.1331,  0.8919, -0.0979,  2.7806,  1.4246,  0.2028,  0.1324,\n          -0.2531],\n         [ 0.8392,  1.2054, -0.0845,  0.6681, -0.9236, -0.1158, -0.5742,\n          -1.4947],\n         [ 0.4182,  0.4420, -1.1173, -1.1566,  0.5043,  1.2998,  0.4086,\n          -0.0851],\n         [-0.4661, -0.9431, -1.1731, -0.6422, -1.9907,  0.1547,  0.0715,\n           0.5975]],\n\n        [[ 0.5925, -0.7206, -0.5015,  0.7751,  0.7715, -0.4696,  0.3488,\n          -1.1856],\n         [-0.4125,  0.6959, -1.4477, -0.4309, -0.7936,  0.0070,  0.7261,\n           1.5541],\n         [ 0.5250, -0.7196, -1.3050, -0.5282,  0.2410, -1.5607,  0.9872,\n          -1.4604],\n         [-1.5076, -0.0878,  0.9464, -0.1485,  1.4986,  0.6900,  0.2807,\n          -2.7928],\n         [-1.1849,  0.3055, -0.7765, -0.1170, -0.4361, -1.3498, -0.4405,\n          -1.2282],\n         [ 0.4359,  0.3526,  0.4144,  1.4148,  0.3031, -0.5850,  0.2245,\n           0.3446],\n         [-1.6893,  0.5114, -0.5336, -0.1644, -0.6745, -0.5652,  1.0763,\n           0.6592],\n         [-1.1908,  1.9425,  0.4116,  1.1966, -1.3087, -1.0719,  0.5678,\n           0.5354],\n         [-0.1416,  1.4666,  0.0801, -0.2778,  0.1393, -0.0257, -2.0645,\n           0.0670],\n         [ 1.1237, -0.0712,  0.1906,  1.1191,  0.6097,  0.3556, -0.9127,\n          -0.5926]]]), (0.95 * tensor([[[ 0.0880,  0.8290, -0.3407, -0.0286, -0.2837, -0.2557,  1.2647,\n           0.2486],\n         [-0.8394,  1.8934,  0.4535,  1.7421, -2.2785,  0.0631,  0.9067,\n           0.2534],\n         [-0.9785,  0.4569, -1.1164,  1.3523, -1.6065,  1.0784, -0.1220,\n          -0.3861],\n         [ 0.5127,  0.4619, -0.6159,  1.4361,  0.3910,  0.8224,  2.8953,\n           1.4008],\n         [ 0.6484,  1.2159,  1.0217,  0.4474,  0.1207,  1.4156, -1.7199,\n           0.0938],\n         [ 1.0853,  0.5618,  0.4575,  0.6170,  0.2228, -0.3441,  1.9663,\n          -1.9010],\n         [-1.2486,  0.9077, -0.1284,  2.8948,  1.4881,  0.2271,  0.0450,\n          -0.1718],\n         [ 0.9431,  1.2219, -0.0837,  0.5569, -1.0472, -0.1326, -0.6114,\n          -1.5601],\n         [ 0.3961,  0.4018, -1.1717, -1.2527,  0.5795,  1.3743,  0.4603,\n          -0.0109],\n         [-0.5127, -1.0160, -1.1761, -0.6151, -2.1220,  0.0944,  0.0538,\n           0.6335]],\n\n        [[ 0.6237, -0.7585, -0.5279,  0.8159,  0.8121, -0.4943,  0.3672,\n          -1.2480],\n         [-0.4654,  0.7704, -1.4975, -0.4944, -0.8760,  0.0321,  0.7460,\n           1.6983],\n         [ 0.5743, -0.7941, -1.2975, -0.5333,  0.2954, -1.6432,  1.0009,\n          -1.6191],\n         [-1.6146, -0.0545,  1.0649, -0.1285,  1.5648,  0.8085,  0.2435,\n          -2.8629],\n         [-1.1680,  0.3262, -0.8672, -0.1153, -0.5379, -1.4572, -0.4784,\n          -1.1459],\n         [ 0.5212,  0.3551,  0.4770,  1.4954,  0.3420, -0.5448,  0.2595,\n           0.4274],\n         [-1.8012,  0.5197, -0.5835, -0.2475, -0.7259, -0.5642,  1.1211,\n           0.6757],\n         [-1.1645,  2.0178,  0.4613,  1.2683, -1.3421, -1.0985,  0.5410,\n           0.5289],\n         [-0.0864,  1.4416,  0.0626, -0.3554,  0.2155,  0.0294, -2.2031,\n           0.0423],\n         [ 1.1903, -0.1521,  0.1964,  1.1927,  0.6344,  0.3757, -0.8521,\n          -0.6273]]])), rtol=0.01)
E        +    where <built-in method allclose of type object at 0x7fada26068a0> = torch.allclose

neuromanifold_gpt/tests/test_ema.py:433: AssertionError
__________________ TestEMAComplexity.test_ema_time_complexity __________________

self = <neuromanifold_gpt.tests.test_ema.TestEMAComplexity object at 0x7facbd8fe2d0>

    def test_ema_time_complexity(self):
        """Verify O(T log T) scaling (rough timing test)."""
        import time
    
        ema = DampedEMA(alpha=0.9)
    
        # Measure time for different sequence lengths
        times = []
        lengths = [256, 512, 1024]  # Use larger T where O(T log T) is more apparent
    
        for T in lengths:
            x = torch.randn(2, T, 16)
    
            # Warmup
            _ = ema(x)
    
            # Time
            start = time.time()
            for _ in range(10):
                _ = ema(x)
            elapsed = time.time() - start
            times.append(elapsed)
    
        # Verify sublinear scaling (O(T log T) grows slower than O(T))
        # If time doubled from 64128, then 128256 should be < 2x
        # (since 2*log(2)  1.44x vs 4x for O(T))
        if len(times) >= 3:
            ratio_1 = times[1] / times[0]  # 128/64
            ratio_2 = times[2] / times[1]  # 256/128
    
            # O(T log T): expect ratio_2  ratio_1 * (log(2)/log(4))  0.72 * ratio_1
            # O(T): expect ratio_2  4.0 if ratio_1  4.0
            # We check ratio_2 < ratio_1 * 1.5 (generous bound)
>           assert ratio_2 < ratio_1 * 1.5, f"Scaling suggests O(T): {ratio_1:.2f} -> {ratio_2:.2f}"
E           AssertionError: Scaling suggests O(T): 0.73 -> 3.63
E           assert 3.6335800807537013 < (0.7268814048475065 * 1.5)

neuromanifold_gpt/tests/test_ema.py:537: AssertionError
___________________________ test_output_shapes_match ___________________________

    def test_output_shapes_match():
        """Old and new paths should produce matching output shapes."""
        embed_dim = 384
        n_heads = 8
        batch_size = 2
        seq_len = 20
    
        # Old path: manual attention with FHN weight modulation
>       attn_old = FHNAttention(
            embed_dim=embed_dim,
            n_heads=n_heads,
            n_fhn_steps=2,
            use_flash_fhn_fusion=False,
        )
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:16: TypeError
_________________________ test_gradient_flow_old_path __________________________

    def test_gradient_flow_old_path():
        """Gradients should flow through old manual attention path."""
>       attn = FHNAttention(
            embed_dim=384,
            n_heads=8,
            n_fhn_steps=2,
            use_flash_fhn_fusion=False,
        )
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:44: TypeError
_________________________ test_gradient_flow_new_path __________________________

    def test_gradient_flow_new_path():
        """Gradients should flow through new Flash Attention fusion path."""
>       attn = FHNAttention(
            embed_dim=384,
            n_heads=8,
            n_fhn_steps=2,
            use_flash_fhn_fusion=True,
        )
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:64: TypeError
______________________ test_fhn_state_computed_both_paths ______________________

    def test_fhn_state_computed_both_paths():
        """Both paths should compute FHN state when n_fhn_steps > 0."""
        x = torch.randn(2, 10, 384)
        spectral_basis = torch.randn(2, 10, 32)
    
>       attn_old = FHNAttention(embed_dim=384, n_heads=8, n_fhn_steps=2, use_flash_fhn_fusion=False)
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:87: TypeError
__________________ test_no_fhn_steps_matches_flash_attention ___________________

    def test_no_fhn_steps_matches_flash_attention():
        """When n_fhn_steps=0, both should use Flash Attention path."""
        x = torch.randn(2, 10, 384)
        spectral_basis = torch.randn(2, 10, 32)
    
>       attn_old = FHNAttention(embed_dim=384, n_heads=8, n_fhn_steps=0, use_flash_fhn_fusion=False)
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:107: TypeError
____________________ test_output_stats_computed_both_paths _____________________

    def test_output_stats_computed_both_paths():
        """Both paths should compute output statistics."""
        x = torch.randn(2, 10, 384)
        spectral_basis = torch.randn(2, 10, 32)
    
>       attn_old = FHNAttention(embed_dim=384, n_heads=8, n_fhn_steps=2, use_flash_fhn_fusion=False)
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:127: TypeError
________________________ test_various_sequence_lengths _________________________

    def test_various_sequence_lengths():
        """Both paths should handle various sequence lengths."""
        embed_dim = 384
        n_heads = 8
    
>       attn_old = FHNAttention(embed_dim=embed_dim, n_heads=n_heads, n_fhn_steps=2, use_flash_fhn_fusion=False)
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:150: TypeError
___________________________ test_various_batch_sizes ___________________________

    def test_various_batch_sizes():
        """Both paths should handle various batch sizes."""
        embed_dim = 384
        n_heads = 8
        seq_len = 10
    
>       attn_old = FHNAttention(embed_dim=embed_dim, n_heads=n_heads, n_fhn_steps=2, use_flash_fhn_fusion=False)
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:170: TypeError
______________________ test_deterministic_with_fixed_seed ______________________

    def test_deterministic_with_fixed_seed():
        """Both paths should be deterministic with fixed seed."""
        embed_dim = 384
        n_heads = 8
    
        def run_with_seed(use_fusion, seed=42):
            torch.manual_seed(seed)
            attn = FHNAttention(
                embed_dim=embed_dim,
                n_heads=n_heads,
                n_fhn_steps=2,
                use_flash_fhn_fusion=use_fusion,
            )
            torch.manual_seed(seed + 1000)
            x = torch.randn(2, 10, embed_dim)
            spectral_basis = torch.randn(2, 10, 32)
            out, _ = attn(x, spectral_basis)
            return out
    
        # Test old path determinism
>       out_old_1 = run_with_seed(False, seed=42)

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:204: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

use_fusion = False, seed = 42

    def run_with_seed(use_fusion, seed=42):
        torch.manual_seed(seed)
>       attn = FHNAttention(
            embed_dim=embed_dim,
            n_heads=n_heads,
            n_fhn_steps=2,
            use_flash_fhn_fusion=use_fusion,
        )
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:191: TypeError
_____________ test_outputs_are_different_due_to_different_proxies ______________

    def test_outputs_are_different_due_to_different_proxies():
        """Old and new paths use different FHN stimulus proxies, so outputs differ."""
        torch.manual_seed(42)
    
        # Use same initialization for fair comparison
>       attn_old = FHNAttention(embed_dim=384, n_heads=8, n_fhn_steps=2, use_flash_fhn_fusion=False)
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:219: TypeError
____________________ test_pulse_widths_positive_both_paths _____________________

    def test_pulse_widths_positive_both_paths():
        """Pulse widths should be positive in both paths."""
        x = torch.randn(2, 10, 384)
        spectral_basis = torch.randn(2, 10, 32)
    
>       attn_old = FHNAttention(embed_dim=384, n_heads=8, n_fhn_steps=2, use_flash_fhn_fusion=False)
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:245: TypeError
___________________ test_backward_compatibility_flag_default ___________________

    def test_backward_compatibility_flag_default():
        """Default should be use_flash_fhn_fusion=True after migration to Flash fusion."""
        attn = FHNAttention(embed_dim=384, n_heads=8, n_fhn_steps=2)
>       assert attn.use_flash_fhn_fusion == True

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:258: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = FHNAttention(
  (qkv): Linear(in_features=384, out_features=1152, bias=False)
  (out_proj): Linear(in_features=384, ou... Softplus(beta=1, threshold=20)
  )
  (partitioner): SpectralPartitioner()
  (dropout): Dropout(p=0.0, inplace=False)
)
name = 'use_flash_fhn_fusion'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'FHNAttention' object has no attribute 'use_flash_fhn_fusion'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
_______________________ test_new_path_attn_probs_is_none _______________________

    def test_new_path_attn_probs_is_none():
        """New Flash Attention path should not compute explicit attention probs."""
        x = torch.randn(2, 10, 384)
        spectral_basis = torch.randn(2, 10, 32)
    
>       attn_new = FHNAttention(embed_dim=384, n_heads=8, n_fhn_steps=2, use_flash_fhn_fusion=True)
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:266: TypeError
_______________________ test_old_path_attn_probs_exists ________________________

    def test_old_path_attn_probs_exists():
        """Old manual attention path should compute explicit attention probs."""
        x = torch.randn(2, 10, 384)
        spectral_basis = torch.randn(2, 10, 32)
    
>       attn_old = FHNAttention(embed_dim=384, n_heads=8, n_fhn_steps=2, use_flash_fhn_fusion=False)
E       TypeError: FHNAttention.__init__() got an unexpected keyword argument 'use_flash_fhn_fusion'

neuromanifold_gpt/tests/test_fhn_flash_fusion.py:278: TypeError
_______________________ test_hierarchical_store_retrieve _______________________

    def test_hierarchical_store_retrieve():
        """Should store and retrieve by SDR similarity from L1."""
        memory = HierarchicalEngramMemory(sdr_size=2048, n_active=40, content_dim=384)
    
        # Create an SDR
        sdr = torch.zeros(2048)
        sdr[:40] = 1
        content = torch.randn(384)
    
        # Store
>       memory.store(sdr, content)

neuromanifold_gpt/tests/test_hierarchical_engram.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
_______________________ test_hierarchical_total_capacity _______________________

    def test_hierarchical_total_capacity():
        """Should track total memories across all tiers."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=5, l2_capacity=10, l3_capacity=15
        )
    
        # Total capacity should be sum of all tiers
>       assert len(memory) == 0
E       TypeError: object of type 'HierarchicalEngramMemory' has no len()

neuromanifold_gpt/tests/test_hierarchical_engram.py:36: TypeError
______________________ test_hierarchical_empty_retrieval _______________________

    def test_hierarchical_empty_retrieval():
        """Should handle retrieval from empty memory."""
        memory = HierarchicalEngramMemory(sdr_size=2048, n_active=40, content_dim=384)
    
        query_sdr = torch.zeros(2048)
        query_sdr[:40] = 1
    
>       retrieved, similarity, tier = memory.retrieve(query_sdr, top_k=5)

neuromanifold_gpt/tests/test_hierarchical_engram.py:53: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'retrieve'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'retrieve'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
___________________________ test_hierarchical_clear ____________________________

    def test_hierarchical_clear():
        """Should clear all memories across all tiers."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=5, l2_capacity=10, l3_capacity=15
        )
    
        # Store some items
        for i in range(8):
            sdr = torch.zeros(2048)
            sdr[i:i+40] = 1
>           memory.store(sdr, torch.randn(384))

neuromanifold_gpt/tests/test_hierarchical_engram.py:71: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
_________________________ test_hierarchical_get_stats __________________________

    def test_hierarchical_get_stats():
        """Should return statistics about memory usage."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=5, l2_capacity=10, l3_capacity=15
        )
    
        # Store 3 items (all should be in L1)
        for i in range(3):
            sdr = torch.zeros(2048)
            sdr[i:i+40] = 1
>           memory.store(sdr, torch.randn(384))

neuromanifold_gpt/tests/test_hierarchical_engram.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
____________________ test_hierarchical_similarity_threshold ____________________

    def test_hierarchical_similarity_threshold():
        """Low similarity should return nothing."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384, threshold=0.5
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_engram.py:111: TypeError
_________________ test_hierarchical_partial_overlap_retrieval __________________

    def test_hierarchical_partial_overlap_retrieval():
        """Should retrieve with partial SDR overlap."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384, threshold=0.3
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_engram.py:130: TypeError
_____________________ test_hierarchical_multiple_retrieval _____________________

    def test_hierarchical_multiple_retrieval():
        """Should retrieve multiple results sorted by similarity."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384, threshold=0.2
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_engram.py:154: TypeError
_________________________ test_store_batch_correctness _________________________

    def test_store_batch_correctness():
        """Should store all items in batch and retrieve them correctly."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384, l1_capacity=10
        )
    
        # Create batch of 5 SDR-content pairs
        batch_size = 5
        sdrs = torch.zeros(batch_size, 2048)
        contents = torch.randn(batch_size, 384)
    
        for i in range(batch_size):
            sdrs[i, i*50:(i*50)+40] = 1  # Non-overlapping SDRs
    
        # Store batch
>       memory.store_batch(sdrs, contents)

neuromanifold_gpt/tests/test_hierarchical_engram.py:196: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store_batch'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store_batch'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
_________________________ test_store_batch_performance _________________________

    def test_store_batch_performance():
        """store_batch() should handle large batches correctly."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384, l1_capacity=500
        )
    
        # Create batch of 100 items
        batch_size = 100
        sdrs = torch.zeros(batch_size, 2048)
        contents = torch.randn(batch_size, 384)
    
        for i in range(batch_size):
            sdrs[i, (i*20) % 2000:(i*20) % 2000 + 40] = 1
    
        # Store batch
>       memory.store_batch(sdrs, contents)

neuromanifold_gpt/tests/test_hierarchical_engram.py:227: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store_batch'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store_batch'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
______________________ test_store_batch_with_l1_overflow _______________________

    def test_store_batch_with_l1_overflow():
        """Batch store should handle L1 overflow with proper tier promotion."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=5, l2_capacity=10, l3_capacity=20
        )
    
        # Store batch larger than L1 capacity
        batch_size = 8
        sdrs = torch.zeros(batch_size, 2048)
        contents = torch.randn(batch_size, 384)
    
        for i in range(batch_size):
            sdrs[i, i*50:(i*50)+40] = 1
    
>       memory.store_batch(sdrs, contents)

neuromanifold_gpt/tests/test_hierarchical_engram.py:255: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store_batch'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store_batch'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
______________________ test_store_batch_with_l2_overflow _______________________

    def test_store_batch_with_l2_overflow():
        """Batch store should cascade promotions through L2 to L3."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=3, l2_capacity=5, l3_capacity=20
        )
    
        # First, fill L1 and L2
        for i in range(8):
            sdr = torch.zeros(2048)
            sdr[i*50:(i*50)+40] = 1
>           memory.store(sdr, torch.randn(384))

neuromanifold_gpt/tests/test_hierarchical_engram.py:281: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
____________________________ test_store_batch_empty ____________________________

    def test_store_batch_empty():
        """Should handle empty batch gracefully."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384
        )
    
        # Store empty batch
        sdrs = torch.zeros(0, 2048)
        contents = torch.zeros(0, 384)
    
>       memory.store_batch(sdrs, contents)

neuromanifold_gpt/tests/test_hierarchical_engram.py:313: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store_batch'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store_batch'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
_________________________ test_store_batch_single_item _________________________

    def test_store_batch_single_item():
        """Should handle single-item batch correctly."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384
        )
    
        # Store single-item batch
        sdrs = torch.zeros(1, 2048)
        sdrs[0, :40] = 1
        contents = torch.randn(1, 384)
    
>       memory.store_batch(sdrs, contents)

neuromanifold_gpt/tests/test_hierarchical_engram.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store_batch'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store_batch'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
_________________________ test_store_batch_equivalence _________________________

    def test_store_batch_equivalence():
        """store_batch() should store all items with proper tier distribution."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=10, l2_capacity=20, l3_capacity=30
        )
    
        # Create test data - use non-overlapping SDRs
        batch_size = 15
        sdrs = torch.zeros(batch_size, 2048)
        contents = torch.randn(batch_size, 384)
    
        # Ensure SDRs don't overlap by using distinct regions
        for i in range(batch_size):
            start_pos = i * 100  # 100 bits apart to avoid any overlap
            sdrs[i, start_pos:start_pos+40] = 1
    
        # Store as batch
>       memory.store_batch(sdrs, contents)

neuromanifold_gpt/tests/test_hierarchical_engram.py:360: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store_batch'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store_batch'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
_________________________ test_tier_promotion_l1_to_l2 _________________________

    def test_tier_promotion_l1_to_l2():
        """Items should be promoted from L1 to L2 when L1 is full."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=3, l2_capacity=10, l3_capacity=20
        )
    
        # Store 3 items to fill L1
        for i in range(3):
            sdr = torch.zeros(2048)
            sdr[i*50:(i*50)+40] = 1
>           memory.store(sdr, torch.randn(384))

neuromanifold_gpt/tests/test_hierarchical_engram.py:392: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
_________________________ test_tier_promotion_l2_to_l3 _________________________

    def test_tier_promotion_l2_to_l3():
        """Items should be promoted from L2 to L3 when both L1 and L2 are full."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=2, l2_capacity=3, l3_capacity=20
        )
    
        # Fill L1 and L2 completely (2 + 3 = 5 items)
        for i in range(5):
            sdr = torch.zeros(2048)
            sdr[i*50:(i*50)+40] = 1
>           memory.store(sdr, torch.randn(384))

neuromanifold_gpt/tests/test_hierarchical_engram.py:419: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
_________________________ test_tier_promotion_cascade __________________________

    def test_tier_promotion_cascade():
        """Should cascade promotions through all tiers correctly."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=2, l2_capacity=2, l3_capacity=10
        )
    
        # Store items and verify cascade behavior
        for i in range(7):
            sdr = torch.zeros(2048)
            sdr[i*100:(i*100)+40] = 1
>           memory.store(sdr, torch.randn(384))

neuromanifold_gpt/tests/test_hierarchical_engram.py:446: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
____________________________ test_capacity_l1_limit ____________________________

    def test_capacity_l1_limit():
        """L1 should enforce capacity limit."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=5, l2_capacity=10, l3_capacity=15
        )
    
        # Store more than L1 capacity
        for i in range(10):
            sdr = torch.zeros(2048)
            sdr[i*50:(i*50)+40] = 1
>           memory.store(sdr, torch.randn(384))

neuromanifold_gpt/tests/test_hierarchical_engram.py:468: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
____________________________ test_capacity_l2_limit ____________________________

    def test_capacity_l2_limit():
        """L2 should enforce capacity limit."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=3, l2_capacity=5, l3_capacity=20
        )
    
        # Store more than L1+L2 capacity
        for i in range(12):
            sdr = torch.zeros(2048)
            sdr[i*50:(i*50)+40] = 1
>           memory.store(sdr, torch.randn(384))

neuromanifold_gpt/tests/test_hierarchical_engram.py:488: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
____________________________ test_capacity_l3_limit ____________________________

    def test_capacity_l3_limit():
        """L3 should enforce capacity limit and evict oldest items."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=2, l2_capacity=3, l3_capacity=5
        )
    
        # Store more than total capacity
        for i in range(15):
            sdr = torch.zeros(2048)
            sdr[i*50:(i*50)+40] = 1
>           memory.store(sdr, torch.randn(384))

neuromanifold_gpt/tests/test_hierarchical_engram.py:509: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
__________________________ test_capacity_total_limit ___________________________

    def test_capacity_total_limit():
        """Total memory should not exceed sum of all tier capacities."""
        memory = HierarchicalEngramMemory(
            sdr_size=2048, n_active=40, content_dim=384,
            l1_capacity=5, l2_capacity=10, l3_capacity=15
        )
    
        # Store many more items than total capacity
        for i in range(50):
            sdr = torch.zeros(2048)
            sdr[i*40:(i*40)+40] = 1
>           memory.store(sdr, torch.randn(384))

neuromanifold_gpt/tests/test_hierarchical_engram.py:531: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = HierarchicalEngramMemory(), name = 'store'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'HierarchicalEngramMemory' object has no attribute 'store'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
_____________________ test_hierarchical_store_retrieve_l1 ______________________

    def test_hierarchical_store_retrieve_l1():
        """Should store and retrieve from L1 tier."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=10,
            l2_capacity=20,
            l3_capacity=50,
            threshold=0.3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:10: TypeError
_________________________ test_hierarchical_tier_stats _________________________

    def test_hierarchical_tier_stats():
        """Should track statistics across all tiers."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=2,
            l2_capacity=3,
            l3_capacity=5,
            threshold=0.3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:38: TypeError
_____________________ test_hierarchical_l1_to_l2_demotion ______________________

    def test_hierarchical_l1_to_l2_demotion():
        """Should demote from L1 to L2 when L1 is full."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=2,
            l2_capacity=5,
            l3_capacity=10,
            threshold=0.3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:67: TypeError
_____________________ test_hierarchical_l2_to_l3_demotion ______________________

    def test_hierarchical_l2_to_l3_demotion():
        """Should demote from L2 to L3 when both L1 and L2 are full."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=2,
            l2_capacity=2,
            l3_capacity=10,
            threshold=0.3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:100: TypeError
_____________________ test_hierarchical_l2_to_l1_promotion _____________________

    def test_hierarchical_l2_to_l1_promotion():
        """Should promote frequently accessed L2 items to L1."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=2,
            l2_capacity=5,
            l3_capacity=10,
            threshold=0.3,
            promotion_threshold=3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:134: TypeError
_____________________ test_hierarchical_l3_to_l1_promotion _____________________

    def test_hierarchical_l3_to_l1_promotion():
        """Should promote frequently accessed L3 items to L1."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=1,
            l2_capacity=1,
            l3_capacity=10,
            threshold=0.3,
            promotion_threshold=3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:175: TypeError
___________________ test_hierarchical_retrieval_across_tiers ___________________

    def test_hierarchical_retrieval_across_tiers():
        """Should retrieve matches from all tiers."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=2,
            l2_capacity=2,
            l3_capacity=5,
            threshold=0.2,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:214: TypeError
____________________ test_hierarchical_similarity_threshold ____________________

    def test_hierarchical_similarity_threshold():
        """Low similarity should return nothing."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=5,
            l2_capacity=5,
            l3_capacity=5,
            threshold=0.5,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:248: TypeError
___________________________ test_hierarchical_clear ____________________________

    def test_hierarchical_clear():
        """Should clear all memories across all tiers."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=2,
            l2_capacity=2,
            l3_capacity=5,
            threshold=0.3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:273: TypeError
______________________ test_hierarchical_empty_retrieval _______________________

    def test_hierarchical_empty_retrieval():
        """Should handle retrieval from empty memory."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=5,
            l2_capacity=5,
            l3_capacity=5,
            threshold=0.3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:304: TypeError
________________________ test_hierarchical_top_k_limit _________________________

    def test_hierarchical_top_k_limit():
        """Should respect top_k parameter."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=10,
            l2_capacity=10,
            l3_capacity=10,
            threshold=0.1,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:326: TypeError
____________________ test_hierarchical_capacity_enforcement ____________________

    def test_hierarchical_capacity_enforcement():
        """Each tier should enforce capacity limits."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=2,
            l2_capacity=3,
            l3_capacity=5,
            threshold=0.3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:360: TypeError
_________________ test_hierarchical_partial_overlap_retrieval __________________

    def test_hierarchical_partial_overlap_retrieval():
        """Should retrieve with partial SDR overlap."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=5,
            l2_capacity=5,
            l3_capacity=5,
            threshold=0.3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:386: TypeError
_________________ test_hierarchical_multiple_retrieval_sorted __________________

    def test_hierarchical_multiple_retrieval_sorted():
        """Should retrieve multiple results sorted by similarity."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=10,
            l2_capacity=10,
            l3_capacity=10,
            threshold=0.2,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:415: TypeError
______________________ test_hierarchical_device_movement _______________________

    def test_hierarchical_device_movement():
        """Memory should move with model to different devices."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=5,
            l2_capacity=5,
            l3_capacity=5,
            threshold=0.3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:446: TypeError
___________________ test_hierarchical_access_count_tracking ____________________

    def test_hierarchical_access_count_tracking():
        """Should track access counts correctly."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=5,
            l2_capacity=5,
            l3_capacity=5,
            threshold=0.3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:470: TypeError
__________________ test_hierarchical_tier_override_threshold ___________________

    def test_hierarchical_tier_override_threshold():
        """Should respect tier_threshold parameter in retrieve."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=5,
            l2_capacity=5,
            l3_capacity=5,
            threshold=0.3,  # Default threshold
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:500: TypeError
_________________________ test_hierarchical_len_method _________________________

    def test_hierarchical_len_method():
        """Should correctly report total memory count."""
>       memory = HierarchicalEngramMemory(
            sdr_size=2048,
            n_active=40,
            content_dim=384,
            l1_capacity=2,
            l2_capacity=3,
            l3_capacity=5,
            threshold=0.3,
        )
E       TypeError: HierarchicalEngramMemory.__init__() got an unexpected keyword argument 'threshold'

neuromanifold_gpt/tests/test_hierarchical_memory.py:529: TypeError
______ TestImaginationOutputShapes.test_imagination_output_shape_no_goal _______

self = <neuromanifold_gpt.tests.test_imagination.TestImaginationOutputShapes object at 0x7facbd9a43e0>

    def test_imagination_output_shape_no_goal(self):
        """Alternatives, scores, and best should have correct shapes."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        x = torch.randn(2, 10, 384)
    
>       result = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:36: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[-1.0935e+00, -1.7411e-01, -2.3765e+00,  ..., -8.2595e-01,
           8.5596e-01, -2.4692e-01],
         [ 9...5171e-01],
         [ 6.1550e-01, -2.3885e+00, -8.4345e-01,  ...,  1.0069e+00,
          -5.0549e-01, -9.1651e-01]]]),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
_____ TestImaginationOutputShapes.test_imagination_output_shape_with_goal ______

self = <neuromanifold_gpt.tests.test_imagination.TestImaginationOutputShapes object at 0x7facbd9a6450>

    def test_imagination_output_shape_with_goal(self):
        """Goal-conditioned generation produces correct shapes."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        x = torch.randn(2, 10, 384)
        goal = torch.randn(2, 10, 384)
    
>       result = imagination(x, goal=goal, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:50: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[-8.3267e-01,  1.1560e-01,  2.6937e-01,  ...,  4.0711e-01,
           6.2373e-01,  2.2703e+00],
         [-7...0525e+00],
         [-1.4600e+00, -2.5939e+00,  7.0987e-01,  ..., -3.5605e-01,
           1.9282e+00,  9.1388e-01]]]),)
kwargs = {'goal': tensor([[[ 0.8150,  3.3462, -0.2209,  ...,  1.7744,  1.2532, -1.4453],
         [-0.6503,  0.2603, -0.3335,  ...9265, -1.7116, -0.7544],
         [-0.7527,  0.2638, -0.0141,  ...,  1.6002, -0.4837, -1.4068]]]), 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
_____ TestImaginationOutputShapes.test_imagination_various_n_alternatives ______

self = <neuromanifold_gpt.tests.test_imagination.TestImaginationOutputShapes object at 0x7facbd9a6e40>

    def test_imagination_various_n_alternatives(self):
        """Works with different numbers of alternatives."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        x = torch.randn(2, 10, 384)
    
        for n_alt in [1, 2, 4, 8]:
>           result = imagination(x, goal=None, n_alternatives=n_alt)

neuromanifold_gpt/tests/test_imagination.py:64: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 0.7324,  0.6126,  1.0988,  ..., -1.6539,  0.7638,  1.2717],
         [-1.0874,  1.3159, -0.4370,  ...,  0...., -1.0885,  ...,  0.8108, -1.0875,  0.1415],
         [-0.7343, -0.4953, -1.7270,  ..., -0.6854,  0.4896, -0.5825]]]),)
kwargs = {'goal': None, 'n_alternatives': 1}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
__________ TestImaginationOutputShapes.test_imagination_single_token ___________

self = <neuromanifold_gpt.tests.test_imagination.TestImaginationOutputShapes object at 0x7facbd9a7290>

    def test_imagination_single_token(self):
        """Handles single token input."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        x = torch.randn(1, 1, 384)
    
>       result = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:77: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[-8.1310e-01,  1.2495e+00, -1.3414e-01, -8.4735e-01, -1.1336e+00,
           9.6891e-01, -1.3450e+00, -2.071...  1.3125e+00,  1.0510e-01,  9.3285e-01, -6.4383e-01,
          -3.4298e-02, -2.2871e-01, -3.3536e-02,  9.5164e-01]]]),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
_______ TestImaginationOutputShapes.test_imagination_various_embed_dims ________

self = <neuromanifold_gpt.tests.test_imagination.TestImaginationOutputShapes object at 0x7facbd9a7260>

    def test_imagination_various_embed_dims(self):
        """Works with various embedding dimensions."""
        for embed_dim in [128, 256, 384, 512]:
            imagination = ConsistencyImaginationModule(
                embed_dim=embed_dim, manifold_dim=64, n_imagination_steps=4
            )
            x = torch.randn(2, 5, embed_dim)
    
>           result = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:91: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[-0.7909, -1.7745, -0.8121,  ..., -0.2630,  1.8088, -0.4591],
         [ 0.1582, -0.0698,  1.5915,  ...,  0...., -0.3777,  ..., -1.6455, -0.9822, -0.2588],
         [-0.0324, -0.6336,  0.4330,  ...,  0.4628,  1.2755,  0.4368]]]),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
_______________ TestImaginationSteps.test_imagination_two_steps ________________

self = <neuromanifold_gpt.tests.test_imagination.TestImaginationSteps object at 0x7facbd9a7e60>

    def test_imagination_two_steps(self):
        """Lightweight diffusion with 2 steps works."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=2
        )
        x = torch.randn(2, 10, 384)
    
>       result = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:108: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 0.0278,  0.7071, -0.8412,  ...,  1.1499,  2.0116, -0.0693],
         [ 1.1317, -0.0632, -1.7249,  ..., -2....,  0.3756,  ..., -0.0922, -0.3147, -0.2900],
         [ 0.8270,  0.5392,  0.4379,  ..., -0.5597,  0.0246,  1.1284]]]),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
_______________ TestImaginationSteps.test_imagination_four_steps _______________

self = <neuromanifold_gpt.tests.test_imagination.TestImaginationSteps object at 0x7facbd9a7380>

    def test_imagination_four_steps(self):
        """Standard diffusion with 4 steps works."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        x = torch.randn(2, 10, 384)
    
>       result = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:120: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[-0.1568, -0.2544, -1.3420,  ..., -0.6902,  1.1667,  0.2849],
         [-0.0683,  1.5101, -0.2162,  ..., -0....,  0.8919,  ...,  1.2591, -0.7721,  1.4649],
         [-0.1435,  0.1697, -1.0463,  ...,  1.1416,  0.4584, -0.8551]]]),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
_____________ TestImaginationSteps.test_noise_schedule_properties ______________

self = <neuromanifold_gpt.tests.test_imagination.TestImaginationSteps object at 0x7facbd9a7140>

    def test_noise_schedule_properties(self):
        """Noise schedule should decrease from 1.0 to 0.0."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
    
>       schedule = imagination.noise_schedule

neuromanifold_gpt/tests/test_imagination.py:131: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule(), name = 'noise_schedule'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'ConsistencyImaginationModule' object has no attribute 'noise_schedule'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
__________ TestGoalConditioning.test_goal_conditioning_affects_output __________

self = <neuromanifold_gpt.tests.test_imagination.TestGoalConditioning object at 0x7facbd9a7b00>

    def test_goal_conditioning_affects_output(self):
        """Goal should influence generated alternatives."""
        torch.manual_seed(42)
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        x = torch.randn(2, 10, 384)
        goal = torch.randn(2, 10, 384)
    
        # Generate with goal
        torch.manual_seed(42)
>       result_with_goal = imagination(x, goal=goal, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:152: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 1.9269,  1.4873,  0.9007,  ...,  0.8541, -0.4901, -0.3595],
         [ 0.6664, -0.0743, -0.2096,  ..., -1....,  2.0012,  ..., -1.2593,  0.4450,  1.5879],
         [ 1.1026,  0.1224, -0.6283,  ..., -0.7991,  0.6081, -0.8028]]]),)
kwargs = {'goal': tensor([[[-0.0572, -0.2434,  0.9149,  ..., -0.4601,  0.1815,  0.1850],
         [ 0.7205, -0.2833,  0.0937,  ...4432,  0.2425,  0.9887],
         [ 0.1103, -0.6392,  0.3695,  ...,  0.6367, -2.1201, -0.1777]]]), 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
________________ TestGoalConditioning.test_goal_affects_scores _________________

self = <neuromanifold_gpt.tests.test_imagination.TestGoalConditioning object at 0x7facbd9a6ed0>

    def test_goal_affects_scores(self):
        """Goal should affect alternative scores."""
        torch.manual_seed(42)
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        x = torch.randn(2, 10, 384)
        goal = torch.randn(2, 10, 384)
    
        # Generate with goal
        torch.manual_seed(42)
>       result_with_goal = imagination(x, goal=goal, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:176: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 1.9269,  1.4873,  0.9007,  ...,  0.8541, -0.4901, -0.3595],
         [ 0.6664, -0.0743, -0.2096,  ..., -1....,  2.0012,  ..., -1.2593,  0.4450,  1.5879],
         [ 1.1026,  0.1224, -0.6283,  ..., -0.7991,  0.6081, -0.8028]]]),)
kwargs = {'goal': tensor([[[-0.0572, -0.2434,  0.9149,  ..., -0.4601,  0.1815,  0.1850],
         [ 0.7205, -0.2833,  0.0937,  ...4432,  0.2425,  0.9887],
         [ 0.1103, -0.6392,  0.3695,  ...,  0.6367, -2.1201, -0.1777]]]), 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
____________________ TestScoreProperties.test_scores_finite ____________________

self = <neuromanifold_gpt.tests.test_imagination.TestScoreProperties object at 0x7facbd9a6870>

    def test_scores_finite(self):
        """Scores should be finite (no NaN or inf)."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        x = torch.randn(2, 10, 384)
    
>       result = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:200: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 1.9269,  1.4873,  0.9007,  ...,  0.8541, -0.4901, -0.3595],
         [ 0.6664, -0.0743, -0.2096,  ..., -1....,  2.0012,  ..., -1.2593,  0.4450,  1.5879],
         [ 1.1026,  0.1224, -0.6283,  ..., -0.7991,  0.6081, -0.8028]]]),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
_____________ TestScoreProperties.test_best_matches_highest_score ______________

self = <neuromanifold_gpt.tests.test_imagination.TestScoreProperties object at 0x7facbd9a6690>

    def test_best_matches_highest_score(self):
        """Best alternative should be the one with highest score."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        x = torch.randn(2, 10, 384)
    
>       result = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:211: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[-0.0572, -0.2434,  0.9149,  ..., -0.4601,  0.1815,  0.1850],
         [ 0.7205, -0.2833,  0.0937,  ...,  0....,  0.9397,  ...,  1.4432,  0.2425,  0.9887],
         [ 0.1103, -0.6392,  0.3695,  ...,  0.6367, -2.1201, -0.1777]]]),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
___________ TestScoreProperties.test_scores_vary_across_alternatives ___________

self = <neuromanifold_gpt.tests.test_imagination.TestScoreProperties object at 0x7facbd9a5f40>

    def test_scores_vary_across_alternatives(self):
        """Scores should vary across different alternatives."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        x = torch.randn(2, 10, 384)
    
>       result = imagination(x, goal=None, n_alternatives=8)

neuromanifold_gpt/tests/test_imagination.py:227: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 0.1593,  0.1944, -0.9836,  ..., -0.4365,  1.1476, -0.1816],
         [-1.0219, -0.5758,  0.8295,  ..., -0....,  0.6129,  ..., -0.1027,  2.0320,  1.5027],
         [ 0.7397, -1.1432,  0.1707,  ..., -0.5098, -1.5227,  1.7940]]]),)
kwargs = {'goal': None, 'n_alternatives': 8}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
_____________ TestGradientFlow.test_gradient_through_alternatives ______________

self = <neuromanifold_gpt.tests.test_imagination.TestGradientFlow object at 0x7facbd9a6c00>

    def test_gradient_through_alternatives(self):
        """Gradients should flow through alternatives generation."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        imagination.train()
        x = torch.randn(2, 10, 384, requires_grad=True)
    
>       result = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:246: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 1.3057,  0.4342, -0.7147,  ...,  0.2544,  0.2557,  0.6576],
         [-1.1559, -1.3886,  1.4598,  ..., -0....0.6783, -0.0343],
         [ 1.1472,  0.2297,  0.5455,  ...,  1.3830, -1.9405,  0.0646]]],
       requires_grad=True),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
________________ TestGradientFlow.test_gradient_through_scores _________________

self = <neuromanifold_gpt.tests.test_imagination.TestGradientFlow object at 0x7facbd9a6b40>

    def test_gradient_through_scores(self):
        """Gradients should flow through score computation."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        imagination.train()
        x = torch.randn(2, 10, 384, requires_grad=True)
    
>       result = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:262: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 0.2468, -0.8822, -0.2938,  ..., -0.4054, -0.3114,  0.3936],
         [ 0.1555, -0.7910, -0.3107,  ...,  0....0.8003, -1.5242],
         [ 0.2354,  1.4249,  0.5611,  ...,  0.9389, -0.7241, -0.4666]]],
       requires_grad=True),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
_________________ TestGradientFlow.test_gradient_through_best __________________

self = <neuromanifold_gpt.tests.test_imagination.TestGradientFlow object at 0x7facbd9a6150>

    def test_gradient_through_best(self):
        """Gradients should flow through best alternative selection."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        imagination.train()
        x = torch.randn(2, 10, 384, requires_grad=True)
    
>       result = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:277: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 0.5249, -0.0187,  0.5637,  ...,  1.5414, -2.5357,  2.5770],
         [ 0.4059,  0.0621,  0.5377,  ...,  1....1.1164, -0.0030],
         [-1.2623, -1.3354,  0.4277,  ...,  0.0294, -0.0817,  1.4616]]],
       requires_grad=True),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
___________________ TestGradientFlow.test_gradient_with_goal ___________________

self = <neuromanifold_gpt.tests.test_imagination.TestGradientFlow object at 0x7facbd9a6a20>

    def test_gradient_with_goal(self):
        """Gradients should flow through goal-conditioned generation."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        imagination.train()
        x = torch.randn(2, 10, 384, requires_grad=True)
        goal = torch.randn(2, 10, 384, requires_grad=True)
    
>       result = imagination(x, goal=goal, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:293: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 0.2083,  0.0910,  0.2347,  ...,  0.1188, -1.6903,  0.6159],
         [-0.5684,  0.0710, -0.9666,  ...,  0....0.0660,  0.3535],
         [ 0.2391,  0.7641,  1.1368,  ..., -0.7156, -1.3654,  0.4461]]],
       requires_grad=True),)
kwargs = {'goal': tensor([[[-0.9828,  0.2697, -0.2956,  ...,  0.4122, -0.1015, -0.5633],
         [ 1.5111,  0.2101, -0.9349,  ...       [ 1.0827,  0.4000, -0.6743,  ..., -0.9012, -0.5152,  0.9621]]],
       requires_grad=True), 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
____________ TestDeterminism.test_eval_mode_deterministic_with_seed ____________

self = <neuromanifold_gpt.tests.test_imagination.TestDeterminism object at 0x7facbd9a63c0>

    def test_eval_mode_deterministic_with_seed(self):
        """Same input and seed produces same output in eval mode."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        imagination.eval()
        x = torch.randn(2, 10, 384)
    
        # First run
        torch.manual_seed(42)
>       result1 = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:316: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 1.2915, -0.4830, -1.3819,  ..., -1.5036, -0.9265, -0.6527],
         [-0.2333,  0.5531,  1.7776,  ..., -0...., -1.0216,  ..., -0.3126,  1.1825, -0.3873],
         [ 0.4817,  1.0128, -0.9610,  ...,  1.0491, -0.9453,  1.1592]]]),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
________ TestDeterminism.test_different_seeds_produce_different_results ________

self = <neuromanifold_gpt.tests.test_imagination.TestDeterminism object at 0x7facbd9a5e80>

    def test_different_seeds_produce_different_results(self):
        """Different seeds should produce different alternatives."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        imagination.eval()
        x = torch.randn(2, 10, 384)
    
        # Run with seed 42
        torch.manual_seed(42)
>       result1 = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:336: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 1.9269,  1.4873,  0.9007,  ...,  0.8541, -0.4901, -0.3595],
         [ 0.6664, -0.0743, -0.2096,  ..., -1....,  2.0012,  ..., -1.2593,  0.4450,  1.5879],
         [ 1.1026,  0.1224, -0.6283,  ..., -0.7991,  0.6081, -0.8028]]]),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
____________________ TestDropout.test_dropout_training_mode ____________________

self = <neuromanifold_gpt.tests.test_imagination.TestDropout object at 0x7facbd9a6720>

    def test_dropout_training_mode(self):
        """Dropout should be active in training mode."""
>       imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4, dropout=0.1
        )
E       TypeError: ConsistencyImaginationModule.__init__() got an unexpected keyword argument 'dropout'

neuromanifold_gpt/tests/test_imagination.py:351: TypeError
______________________ TestDropout.test_dropout_eval_mode ______________________

self = <neuromanifold_gpt.tests.test_imagination.TestDropout object at 0x7facbd9a6c30>

    def test_dropout_eval_mode(self):
        """Dropout should be inactive in eval mode."""
>       imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4, dropout=0.1
        )
E       TypeError: ConsistencyImaginationModule.__init__() got an unexpected keyword argument 'dropout'

neuromanifold_gpt/tests/test_imagination.py:369: TypeError
__________________ TestBatchSizeVariations.test_single_batch ___________________

self = <neuromanifold_gpt.tests.test_imagination.TestBatchSizeVariations object at 0x7facbd9a70b0>

    def test_single_batch(self):
        """Handles single batch input."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        x = torch.randn(1, 10, 384)
    
>       result = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:395: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[ 1.9269,  1.4873,  0.9007,  ...,  0.8541, -0.4901, -0.3595],
         [ 0.6664, -0.0743, -0.2096,  ..., -1...., -0.6110,  ...,  1.3490,  1.6593, -0.6821],
         [ 0.8592,  1.0688,  1.0354,  ..., -1.5511, -1.4303,  0.2053]]]),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
___________________ TestBatchSizeVariations.test_large_batch ___________________

self = <neuromanifold_gpt.tests.test_imagination.TestBatchSizeVariations object at 0x7facbd9a79b0>

    def test_large_batch(self):
        """Handles larger batch sizes."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
        x = torch.randn(16, 10, 384)
    
>       result = imagination(x, goal=None, n_alternatives=4)

neuromanifold_gpt/tests/test_imagination.py:408: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule()
args = (tensor([[[-0.1592,  0.0515,  0.6379,  ...,  1.6612, -2.6223, -0.4319],
         [-0.1010, -0.4388, -1.9775,  ..., -1...., -0.3629,  ..., -1.4409, -0.3512, -0.8706],
         [-0.0526,  1.1049,  0.1912,  ..., -0.1606, -0.7286, -1.1202]]]),)
kwargs = {'goal': None, 'n_alternatives': 4}
forward_call = <bound method ConsistencyImaginationModule.forward of ConsistencyImaginationModule()>

    def _call_impl(self, *args, **kwargs):
        forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
        # If we don't have any hooks, we want to skip the rest of the logic in
        # this function, and just call forward.
        if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
                or _global_backward_pre_hooks or _global_backward_hooks
                or _global_forward_hooks or _global_forward_pre_hooks):
>           return forward_call(*args, **kwargs)
E           TypeError: ConsistencyImaginationModule.forward() got an unexpected keyword argument 'goal'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: TypeError
______________ TestInternalComponents.test_denoiser_output_shape _______________

self = <neuromanifold_gpt.tests.test_imagination.TestInternalComponents object at 0x7facbd9a7650>

    def test_denoiser_output_shape(self):
        """Denoiser should output correct shape."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
    
        # Create dummy input for denoiser
        # Input: (noisy_x, manifold_coords, timestep)
        B, n_alt, T, D = 2, 4, 10, 384
        D_m = 64
        denoiser_input = torch.randn(B, n_alt, T, D + D_m + 1)
    
>       output = imagination.denoiser(denoiser_input)

neuromanifold_gpt/tests/test_imagination.py:430: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule(), name = 'denoiser'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'ConsistencyImaginationModule' object has no attribute 'denoiser'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
____________ TestInternalComponents.test_goal_encoder_output_shape _____________

self = <neuromanifold_gpt.tests.test_imagination.TestInternalComponents object at 0x7facbd9a6330>

    def test_goal_encoder_output_shape(self):
        """Goal encoder should output correct shape."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
    
        goal = torch.randn(2, 384)
>       encoded_goal = imagination.goal_encoder(goal)

neuromanifold_gpt/tests/test_imagination.py:441: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule(), name = 'goal_encoder'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'ConsistencyImaginationModule' object has no attribute 'goal_encoder'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
_______________ TestInternalComponents.test_scorer_output_shape ________________

self = <neuromanifold_gpt.tests.test_imagination.TestInternalComponents object at 0x7facbd9a5d60>

    def test_scorer_output_shape(self):
        """Scorer should output scalar scores."""
        imagination = ConsistencyImaginationModule(
            embed_dim=384, manifold_dim=64, n_imagination_steps=4
        )
    
        # Input: (alternative_embedding, manifold_coords)
        scorer_input = torch.randn(2, 4, 384 + 64)
>       scores = imagination.scorer(scorer_input).squeeze(-1)

neuromanifold_gpt/tests/test_imagination.py:453: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ConsistencyImaginationModule(), name = 'scorer'

    def __getattr__(self, name: str) -> Any:
        if '_parameters' in self.__dict__:
            _parameters = self.__dict__['_parameters']
            if name in _parameters:
                return _parameters[name]
        if '_buffers' in self.__dict__:
            _buffers = self.__dict__['_buffers']
            if name in _buffers:
                return _buffers[name]
        if '_modules' in self.__dict__:
            modules = self.__dict__['_modules']
            if name in modules:
                return modules[name]
>       raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
E       AttributeError: 'ConsistencyImaginationModule' object has no attribute 'scorer'

venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1688: AttributeError
________________ TestGradientFlow.test_gradient_through_metric _________________

self = <neuromanifold_gpt.tests.test_manifold.TestGradientFlow object at 0x7facbd9fc560>

    def test_gradient_through_metric(self):
        """Gradients should flow through metric computation."""
        proj = ManifoldProjection(sdr_size=2048, manifold_dim=64)
        proj.train()
        sdr = torch.randn(2, 10, 2048, requires_grad=True)
    
        _, metric = proj(sdr)
        loss = metric.sum()
        loss.backward()
    
        assert sdr.grad is not None
>       assert sdr.grad.abs().sum() > 0
E       assert tensor(0.) > 0
E        +  where tensor(0.) = <built-in method sum of Tensor object at 0x7facbd9ce3f0>()
E        +    where <built-in method sum of Tensor object at 0x7facbd9ce3f0> = tensor([[[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         ...,\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.]],\n\n        [[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         ...,\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.]]]).sum
E        +      where tensor([[[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         ...,\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.]],\n\n        [[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         ...,\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.]]]) = <built-in method abs of Tensor object at 0x7facbd9cc140>()
E        +        where <built-in method abs of Tensor object at 0x7facbd9cc140> = tensor([[[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         ...,\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.]],\n\n        [[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         ...,\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.]]]).abs
E        +          where tensor([[[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         ...,\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.]],\n\n        [[0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         ...,\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.],\n         [0., 0., 0.,  ..., 0., 0., 0.]]]) = tensor([[[-1.9023,  0.8746, -0.7314,  ...,  1.2168,  0.2375, -1.6283],\n         [ 2.8008,  2.0300, -1.2029,  ...,  0.8110,  0.0333, -1.3250],\n         [-0.2955,  1.0802, -1.0939,  ...,  0.3049,  0.3955, -1.4299],\n         ...,\n         [-0.6248, -0.7020, -0.5755,  ...,  0.6276,  1.4949, -1.4528],\n         [ 0.1408, -0.5653, -0.1537,  ..., -0.6071, -0.0043, -0.7552],\n         [ 0.5340,  0.9651, -0.9271,  ...,  1.0397,  1.7487,  0.2035]],\n\n        [[-0.2192,  2.2786,  0.2642,  ..., -0.8826,  0.6854,  0.3544],\n         [ 1.7773,  0.1950, -2.5089,  ...,  0.4037,  0.4779, -0.1688],\n         [-0.5145, -0.7641, -0.2532,  ..., -0.3874, -0.6538,  1.0619],\n         ...,\n         [-1.0114, -0.7184, -1.6707,  ..., -0.3199, -0.3318,  1.0971],\n         [-1.1719, -0.4436, -0.4609,  ..., -0.3950, -1.6511,  0.2347],\n         [-0.9602,  1.2741,  0.3698,  ...,  0.6539, -1.2079,  0.0603]]],\n       requires_grad=True).grad

neuromanifold_gpt/tests/test_manifold.py:169: AssertionError
_________________________ test_learned_pos_emb_forward _________________________

    def test_learned_pos_emb_forward():
        """Learned position embeddings should work in forward pass."""
>       config = NeuroManifoldConfigNano(pos_emb_type='learned')
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:17: TypeError
________________________ test_ramanujan_pos_emb_forward ________________________

    def test_ramanujan_pos_emb_forward():
        """Ramanujan position embeddings should work in forward pass."""
>       config = NeuroManifoldConfigNano(pos_emb_type='ramanujan')
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:29: TypeError
_________________________ test_rotary_pos_emb_forward __________________________

    def test_rotary_pos_emb_forward():
        """Rotary position embeddings should work in forward pass."""
>       config = NeuroManifoldConfigNano(pos_emb_type='rotary')
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:41: TypeError
__________________________ test_alibi_pos_emb_forward __________________________

    def test_alibi_pos_emb_forward():
        """ALiBi position embeddings should work in forward pass."""
>       config = NeuroManifoldConfigNano(pos_emb_type='alibi')
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:53: TypeError
_________________ test_all_pos_emb_types_with_targets[learned] _________________

pos_emb_type = 'learned'

    def test_all_pos_emb_types_with_targets(pos_emb_type):
        """All position embedding types should compute loss when targets provided."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:65: TypeError
________________ test_all_pos_emb_types_with_targets[ramanujan] ________________

pos_emb_type = 'ramanujan'

    def test_all_pos_emb_types_with_targets(pos_emb_type):
        """All position embedding types should compute loss when targets provided."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:65: TypeError
_________________ test_all_pos_emb_types_with_targets[rotary] __________________

pos_emb_type = 'rotary'

    def test_all_pos_emb_types_with_targets(pos_emb_type):
        """All position embedding types should compute loss when targets provided."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:65: TypeError
__________________ test_all_pos_emb_types_with_targets[alibi] __________________

pos_emb_type = 'alibi'

    def test_all_pos_emb_types_with_targets(pos_emb_type):
        """All position embedding types should compute loss when targets provided."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:65: TypeError
___________________ test_all_pos_emb_types_generate[learned] ___________________

pos_emb_type = 'learned'

    def test_all_pos_emb_types_generate(pos_emb_type):
        """All position embedding types should support generation."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:80: TypeError
__________________ test_all_pos_emb_types_generate[ramanujan] __________________

pos_emb_type = 'ramanujan'

    def test_all_pos_emb_types_generate(pos_emb_type):
        """All position embedding types should support generation."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:80: TypeError
___________________ test_all_pos_emb_types_generate[rotary] ____________________

pos_emb_type = 'rotary'

    def test_all_pos_emb_types_generate(pos_emb_type):
        """All position embedding types should support generation."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:80: TypeError
____________________ test_all_pos_emb_types_generate[alibi] ____________________

pos_emb_type = 'alibi'

    def test_all_pos_emb_types_generate(pos_emb_type):
        """All position embedding types should support generation."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:80: TypeError
__________ test_all_pos_emb_types_produce_different_outputs[learned] ___________

pos_emb_type = 'learned'

    def test_all_pos_emb_types_produce_different_outputs(pos_emb_type):
        """Different position embedding types should produce different outputs."""
        # Get output from current position embedding type
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:94: TypeError
_________ test_all_pos_emb_types_produce_different_outputs[ramanujan] __________

pos_emb_type = 'ramanujan'

    def test_all_pos_emb_types_produce_different_outputs(pos_emb_type):
        """Different position embedding types should produce different outputs."""
        # Get output from current position embedding type
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:94: TypeError
___________ test_all_pos_emb_types_produce_different_outputs[rotary] ___________

pos_emb_type = 'rotary'

    def test_all_pos_emb_types_produce_different_outputs(pos_emb_type):
        """Different position embedding types should produce different outputs."""
        # Get output from current position embedding type
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:94: TypeError
___________ test_all_pos_emb_types_produce_different_outputs[alibi] ____________

pos_emb_type = 'alibi'

    def test_all_pos_emb_types_produce_different_outputs(pos_emb_type):
        """Different position embedding types should produce different outputs."""
        # Get output from current position embedding type
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:94: TypeError
__________________ test_all_pos_emb_types_info_dict[learned] ___________________

pos_emb_type = 'learned'

    def test_all_pos_emb_types_info_dict(pos_emb_type):
        """All position embedding types should produce info dict."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:119: TypeError
_________________ test_all_pos_emb_types_info_dict[ramanujan] __________________

pos_emb_type = 'ramanujan'

    def test_all_pos_emb_types_info_dict(pos_emb_type):
        """All position embedding types should produce info dict."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:119: TypeError
___________________ test_all_pos_emb_types_info_dict[rotary] ___________________

pos_emb_type = 'rotary'

    def test_all_pos_emb_types_info_dict(pos_emb_type):
        """All position embedding types should produce info dict."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:119: TypeError
___________________ test_all_pos_emb_types_info_dict[alibi] ____________________

pos_emb_type = 'alibi'

    def test_all_pos_emb_types_info_dict(pos_emb_type):
        """All position embedding types should produce info dict."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:119: TypeError
________________ test_learned_vs_ramanujan_different_positions _________________

    def test_learned_vs_ramanujan_different_positions():
        """Learned and Ramanujan embeddings should encode position differently."""
>       config_learned = NeuroManifoldConfigNano(pos_emb_type='learned')
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:133: TypeError
__________________ test_rotary_vs_alibi_different_mechanisms ___________________

    def test_rotary_vs_alibi_different_mechanisms():
        """RoPE and ALiBi should use different position encoding mechanisms."""
>       config_rotary = NeuroManifoldConfigNano(pos_emb_type='rotary')
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:154: TypeError
________________ test_all_pos_emb_types_gradient_flow[learned] _________________

pos_emb_type = 'learned'

    def test_all_pos_emb_types_gradient_flow(pos_emb_type):
        """All position embedding types should allow gradient flow."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:175: TypeError
_______________ test_all_pos_emb_types_gradient_flow[ramanujan] ________________

pos_emb_type = 'ramanujan'

    def test_all_pos_emb_types_gradient_flow(pos_emb_type):
        """All position embedding types should allow gradient flow."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:175: TypeError
_________________ test_all_pos_emb_types_gradient_flow[rotary] _________________

pos_emb_type = 'rotary'

    def test_all_pos_emb_types_gradient_flow(pos_emb_type):
        """All position embedding types should allow gradient flow."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:175: TypeError
_________________ test_all_pos_emb_types_gradient_flow[alibi] __________________

pos_emb_type = 'alibi'

    def test_all_pos_emb_types_gradient_flow(pos_emb_type):
        """All position embedding types should allow gradient flow."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:175: TypeError
____________________ test_batch_size_independence[learned] _____________________

pos_emb_type = 'learned'

    def test_batch_size_independence(pos_emb_type):
        """Position embeddings should work with different batch sizes."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:207: TypeError
___________________ test_batch_size_independence[ramanujan] ____________________

pos_emb_type = 'ramanujan'

    def test_batch_size_independence(pos_emb_type):
        """Position embeddings should work with different batch sizes."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:207: TypeError
_____________________ test_batch_size_independence[rotary] _____________________

pos_emb_type = 'rotary'

    def test_batch_size_independence(pos_emb_type):
        """Position embeddings should work with different batch sizes."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:207: TypeError
_____________________ test_batch_size_independence[alibi] ______________________

pos_emb_type = 'alibi'

    def test_batch_size_independence(pos_emb_type):
        """Position embeddings should work with different batch sizes."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:207: TypeError
__________________ test_sequence_length_independence[learned] __________________

pos_emb_type = 'learned'

    def test_sequence_length_independence(pos_emb_type):
        """Position embeddings should work with different sequence lengths."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:226: TypeError
_________________ test_sequence_length_independence[ramanujan] _________________

pos_emb_type = 'ramanujan'

    def test_sequence_length_independence(pos_emb_type):
        """Position embeddings should work with different sequence lengths."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:226: TypeError
__________________ test_sequence_length_independence[rotary] ___________________

pos_emb_type = 'rotary'

    def test_sequence_length_independence(pos_emb_type):
        """Position embeddings should work with different sequence lengths."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:226: TypeError
___________________ test_sequence_length_independence[alibi] ___________________

pos_emb_type = 'alibi'

    def test_sequence_length_independence(pos_emb_type):
        """Position embeddings should work with different sequence lengths."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:226: TypeError
_____________________ test_learned_pos_emb_initialization ______________________

    def test_learned_pos_emb_initialization():
        """Learned position embeddings should be properly initialized."""
>       config = NeuroManifoldConfigNano(pos_emb_type='learned')
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:245: TypeError
____________________ test_ramanujan_pos_emb_initialization _____________________

    def test_ramanujan_pos_emb_initialization():
        """Ramanujan position embeddings should be properly initialized."""
>       config = NeuroManifoldConfigNano(pos_emb_type='ramanujan')
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:256: TypeError
______________________ test_rotary_pos_emb_initialization ______________________

    def test_rotary_pos_emb_initialization():
        """Rotary position embeddings should be properly initialized."""
>       config = NeuroManifoldConfigNano(pos_emb_type='rotary')
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:267: TypeError
______________________ test_alibi_pos_emb_initialization _______________________

    def test_alibi_pos_emb_initialization():
        """ALiBi position embeddings should be properly initialized."""
>       config = NeuroManifoldConfigNano(pos_emb_type='alibi')
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:279: TypeError
__________________________ test_invalid_pos_emb_type ___________________________

    def test_invalid_pos_emb_type():
        """Should raise error for invalid position embedding type."""
>       config = NeuroManifoldConfigNano(pos_emb_type='invalid')
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:291: TypeError
________________ test_all_pos_emb_types_deterministic[learned] _________________

pos_emb_type = 'learned'

    def test_all_pos_emb_types_deterministic(pos_emb_type):
        """All position embedding types should be deterministic given same seed."""
        torch.manual_seed(42)
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:300: TypeError
_______________ test_all_pos_emb_types_deterministic[ramanujan] ________________

pos_emb_type = 'ramanujan'

    def test_all_pos_emb_types_deterministic(pos_emb_type):
        """All position embedding types should be deterministic given same seed."""
        torch.manual_seed(42)
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:300: TypeError
_________________ test_all_pos_emb_types_deterministic[rotary] _________________

pos_emb_type = 'rotary'

    def test_all_pos_emb_types_deterministic(pos_emb_type):
        """All position embedding types should be deterministic given same seed."""
        torch.manual_seed(42)
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:300: TypeError
_________________ test_all_pos_emb_types_deterministic[alibi] __________________

pos_emb_type = 'alibi'

    def test_all_pos_emb_types_deterministic(pos_emb_type):
        """All position embedding types should be deterministic given same seed."""
        torch.manual_seed(42)
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:300: TypeError
______________ test_all_pos_emb_types_memory_efficiency[learned] _______________

pos_emb_type = 'learned'

    def test_all_pos_emb_types_memory_efficiency(pos_emb_type):
        """All position embedding types should not cause memory leaks."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:318: TypeError
_____________ test_all_pos_emb_types_memory_efficiency[ramanujan] ______________

pos_emb_type = 'ramanujan'

    def test_all_pos_emb_types_memory_efficiency(pos_emb_type):
        """All position embedding types should not cause memory leaks."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:318: TypeError
_______________ test_all_pos_emb_types_memory_efficiency[rotary] _______________

pos_emb_type = 'rotary'

    def test_all_pos_emb_types_memory_efficiency(pos_emb_type):
        """All position embedding types should not cause memory leaks."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:318: TypeError
_______________ test_all_pos_emb_types_memory_efficiency[alibi] ________________

pos_emb_type = 'alibi'

    def test_all_pos_emb_types_memory_efficiency(pos_emb_type):
        """All position embedding types should not cause memory leaks."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:318: TypeError
_____________________ test_rotary_extrapolation_capability _____________________

    def test_rotary_extrapolation_capability():
        """RoPE should enable better extrapolation to longer sequences."""
>       config = NeuroManifoldConfigNano(pos_emb_type='rotary', block_size=128)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:337: TypeError
_____________________ test_alibi_extrapolation_capability ______________________

    def test_alibi_extrapolation_capability():
        """ALiBi should enable better extrapolation to longer sequences."""
>       config = NeuroManifoldConfigNano(pos_emb_type='alibi', block_size=128)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:359: TypeError
___________________ test_all_pos_emb_types_with_sdr[learned] ___________________

pos_emb_type = 'learned'

    def test_all_pos_emb_types_with_sdr(pos_emb_type):
        """All position embedding types should work with SDR enabled."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type, use_sdr=True)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:381: TypeError
__________________ test_all_pos_emb_types_with_sdr[ramanujan] __________________

pos_emb_type = 'ramanujan'

    def test_all_pos_emb_types_with_sdr(pos_emb_type):
        """All position embedding types should work with SDR enabled."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type, use_sdr=True)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:381: TypeError
___________________ test_all_pos_emb_types_with_sdr[rotary] ____________________

pos_emb_type = 'rotary'

    def test_all_pos_emb_types_with_sdr(pos_emb_type):
        """All position embedding types should work with SDR enabled."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type, use_sdr=True)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:381: TypeError
____________________ test_all_pos_emb_types_with_sdr[alibi] ____________________

pos_emb_type = 'alibi'

    def test_all_pos_emb_types_with_sdr(pos_emb_type):
        """All position embedding types should work with SDR enabled."""
>       config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type, use_sdr=True)
E       TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:381: TypeError
______________________ test_pos_emb_type_saved_in_config _______________________

    def test_pos_emb_type_saved_in_config():
        """Position embedding type should be saved in model config."""
        for pos_emb_type in ['learned', 'ramanujan', 'rotary', 'alibi']:
>           config = NeuroManifoldConfigNano(pos_emb_type=pos_emb_type)
E           TypeError: NeuroManifoldConfigNano.__init__() got an unexpected keyword argument 'pos_emb_type'

neuromanifold_gpt/tests/test_position_embeddings.py:394: TypeError
_______________ TestEncoderOutputShape.test_encoder_output_shape _______________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestEncoderOutputShape object at 0x7fac878676b0>

    def test_encoder_output_shape(self):
        """SDR output should have correct shape and sparsity."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        tokens = torch.randint(0, 1000, (2, 20))
    
>       sdr, scores = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:30: ValueError
_______________ TestEncoderOutputShape.test_encoder_single_token _______________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestEncoderOutputShape object at 0x7fac878643b0>

    def test_encoder_single_token(self):
        """Encoder handles single token input."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.eval()
        tokens = torch.randint(0, 1000, (1, 1))
    
>       sdr, scores = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:43: ValueError
_______________ TestEncoderOutputShape.test_encoder_batch_sizes ________________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestEncoderOutputShape object at 0x7fac87809a00>

    def test_encoder_batch_sizes(self):
        """Encoder handles various batch sizes."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.eval()
    
        for batch_size in [1, 4, 16]:
            tokens = torch.randint(0, 1000, (batch_size, 10))
>           sdr, _ = encoder(tokens)
E           ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:57: ValueError
__________________ TestEncoderSparsity.test_encoder_sparsity ___________________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestEncoderSparsity object at 0x7fac878094c0>

    def test_encoder_sparsity(self):
        """SDR should have exactly n_active bits per token."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.eval()  # Use hard top-k
        tokens = torch.randint(0, 1000, (2, 20))
    
>       sdr, _ = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:72: ValueError
________________ TestEncoderSparsity.test_encoder_binary_values ________________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestEncoderSparsity object at 0x7fac87809910>

    def test_encoder_binary_values(self):
        """SDR values should be 0 or 1."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.eval()
        tokens = torch.randint(0, 1000, (2, 20))
    
>       sdr, _ = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:85: ValueError
_______________ TestEncoderSparsity.test_training_mode_sparsity ________________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestEncoderSparsity object at 0x7fac878093d0>

    def test_training_mode_sparsity(self):
        """Training mode should also produce approximately correct sparsity."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.train()
        tokens = torch.randint(0, 1000, (2, 20))
    
>       sdr, _ = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:97: ValueError
_____________ TestSemanticSimilarity.test_semantic_similarity_self _____________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestSemanticSimilarity object at 0x7fac87808fb0>

    def test_semantic_similarity_self(self):
        """Token should have similarity 1.0 with itself."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.eval()
        tokens = torch.randint(0, 1000, (1, 5))
    
>       sdr, _ = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:116: ValueError
_______ TestSemanticSimilarity.test_semantic_similarity_different_tokens _______

self = <neuromanifold_gpt.tests.test_semantic_folding.TestSemanticSimilarity object at 0x7fac87809220>

    def test_semantic_similarity_different_tokens(self):
        """Different tokens generally have < 1.0 similarity."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.eval()
        # Use specific different tokens
        tokens = torch.tensor([[0, 100]])
    
>       sdr, _ = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:130: ValueError
____________________ TestPhraseEncoding.test_encode_phrase _____________________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestPhraseEncoding object at 0x7fac87808ef0>

    def test_encode_phrase(self):
        """Phrase encoding should union token SDRs."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.eval()
        tokens = torch.randint(0, 1000, (1, 5))
    
>       sdr, _ = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:149: ValueError
________________ TestPhraseEncoding.test_encode_phrase_batched _________________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestPhraseEncoding object at 0x7fac87808f50>

    def test_encode_phrase_batched(self):
        """Phrase encoding works with batched input."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.eval()
        tokens = torch.randint(0, 1000, (4, 5))
    
>       sdr, _ = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:163: ValueError
________________ TestGradientFlow.test_gradient_through_encoder ________________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestGradientFlow object at 0x7fac87808e00>

    def test_gradient_through_encoder(self):
        """Gradients should flow back through encoder."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.train()
        tokens = torch.randint(0, 1000, (2, 10))
    
>       sdr, scores = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:181: ValueError
__________________ TestGradientFlow.test_gradient_through_sdr __________________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestGradientFlow object at 0x7fac87808a10>

    def test_gradient_through_sdr(self):
        """SDR output allows gradient flow via soft_topk."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.train()
        tokens = torch.randint(0, 1000, (2, 10))
    
>       sdr, _ = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:197: ValueError
_________________ TestDeterminism.test_eval_mode_deterministic _________________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestDeterminism object at 0x7fac87808c80>

    def test_eval_mode_deterministic(self):
        """Same input should produce same output in eval mode."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.eval()
        tokens = torch.randint(0, 1000, (2, 10))
    
>       sdr1, _ = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:216: ValueError
____________ TestEncoderComponents.test_context_encoder_integration ____________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestEncoderComponents object at 0x7fac878089b0>

    def test_context_encoder_integration(self):
        """Context encoder should modulate embeddings."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256,
            context_size=5
        )
        encoder.eval()
    
        # Context should matter - changing surrounding tokens may change SDR
        # This is a loose test since context effect isn't guaranteed to be visible
        tokens = torch.randint(0, 1000, (1, 20))
>       sdr, _ = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:236: ValueError
____________ TestBoostingMechanism.test_boosting_updates_duty_cycle ____________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestBoostingMechanism object at 0x7fac87808140>

    def test_boosting_updates_duty_cycle(self):
        """Training should update bit duty cycle."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.train()
    
        initial_duty = encoder.bit_duty_cycle.clone()
    
        # Run a few training steps
        for _ in range(5):
            tokens = torch.randint(0, 1000, (4, 20))
>           sdr, _ = encoder(tokens)
E           ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:268: ValueError
_____________ TestBoostingMechanism.test_boosting_disabled_in_eval _____________

self = <neuromanifold_gpt.tests.test_semantic_folding.TestBoostingMechanism object at 0x7fac8780b590>

    def test_boosting_disabled_in_eval(self):
        """Boosting should not affect eval mode."""
        encoder = SemanticFoldingEncoder(
            vocab_size=1000, sdr_size=2048, n_active=40, embed_dim=256
        )
        encoder.eval()
    
        initial_duty = encoder.bit_duty_cycle.clone()
    
        tokens = torch.randint(0, 1000, (4, 20))
>       sdr, _ = encoder(tokens)
E       ValueError: too many values to unpack (expected 2)

neuromanifold_gpt/tests/test_semantic_folding.py:283: ValueError
________________________ test_spectral_basis_normalized ________________________

    def test_spectral_basis_normalized():
        """Spectral basis should sum to 1 per position (softmax)."""
        spectral = SpectralDecomposition(manifold_dim=64, n_eigenvectors=16)
        coords = torch.randn(1, 20, 64)
    
        basis, _, _ = spectral(coords)
    
        # With softmax, each row sums to 1
        row_sums = basis[0].sum(dim=-1)
>       assert torch.allclose(row_sums, torch.ones(20), atol=1e-5)
E       assert False
E        +  where False = <built-in method allclose of type object at 0x7fada26068a0>(tensor([ 0.3384,  0.1000,  0.3430, -0.1152, -0.1941, -0.2748, -0.0382,  0.0955,\n         0.0444, -0.0264,  0.0861,  0.1467,  0.0615,  0.0673,  0.2422,  0.0116,\n        -0.0272, -0.1694, -0.2899, -0.0741], grad_fn=<SumBackward1>), tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,\n        1., 1.]), atol=1e-05)
E        +    where <built-in method allclose of type object at 0x7fada26068a0> = torch.allclose
E        +    and   tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,\n        1., 1.]) = <built-in method ones of type object at 0x7fada26068a0>(20)
E        +      where <built-in method ones of type object at 0x7fada26068a0> = torch.ones

neuromanifold_gpt/tests/test_spectral.py:29: AssertionError
________________ TestChunkedSpectralAttention.test_memory_usage ________________

self = <neuromanifold_gpt.tests.test_spectral_chunked.TestChunkedSpectralAttention object at 0x7fac8780a390>

    def test_memory_usage(self):
        """Verify chunked implementation uses significantly less memory than non-chunked.
    
        Expected memory reduction: 40-60% for large sequences (T=1024+).
        Original: O(B * H * T * n_eig^2) memory
        Chunked: O(B * H * chunk_size * n_eig^2) memory
        """
        # Test configuration: large sequence to demonstrate memory savings
        B, H, T, n_eig, chunk_size = 16, 8, 1024, 32, 128
        embed_dim = n_eig * H  # 256
    
        # Create attention module
        attn = FastSpectralAttention(embed_dim=embed_dim, n_eigenvectors=n_eig, n_heads=H, chunk_size=chunk_size)
    
        # Generate test data
        k = torch.randn(B, H, T, n_eig)
        v = torch.randn(B, H, T, n_eig)
    
        # Calculate theoretical peak memory usage (in number of elements)
        # Non-chunked: materializes full (B, H, T, n_eig, n_eig) tensor
        non_chunked_peak_elements = B * H * T * n_eig * n_eig
    
        # Chunked: materializes (B, H, chunk_size, n_eig, n_eig) per chunk
        # Plus running state (B, H, n_eig, n_eig)
        chunked_peak_elements = B * H * chunk_size * n_eig * n_eig + B * H * n_eig * n_eig
    
        # Calculate memory in MB (assuming float32 = 4 bytes)
        bytes_per_element = 4
        non_chunked_mb = (non_chunked_peak_elements * bytes_per_element) / (1024 ** 2)
        chunked_mb = (chunked_peak_elements * bytes_per_element) / (1024 ** 2)
    
        # Calculate memory reduction
        memory_reduction_pct = ((non_chunked_peak_elements - chunked_peak_elements) / non_chunked_peak_elements) * 100
    
        print(f"\n{'='*60}")
        print(f"Memory Benchmark: T={T}, n_eig={n_eig}, chunk_size={chunk_size}")
        print(f"{'='*60}")
        print(f"Configuration: B={B}, H={H}, T={T}, n_eig={n_eig}")
        print(f"Non-chunked peak memory: {non_chunked_mb:.2f} MB ({non_chunked_peak_elements:,} elements)")
        print(f"Chunked peak memory:     {chunked_mb:.2f} MB ({chunked_peak_elements:,} elements)")
        print(f"Memory reduction:        {memory_reduction_pct:.1f}%")
        print(f"{'='*60}")
    
        # Verify memory reduction meets expected threshold (40-60% or better)
        assert memory_reduction_pct >= 40.0, \
            f"Memory reduction {memory_reduction_pct:.1f}% is below expected 40% threshold"
    
        # If CUDA is available, measure actual memory usage
        if torch.cuda.is_available():
            device = torch.device('cuda')
            k_cuda = k.to(device)
            v_cuda = v.to(device)
            attn_cuda = FastSpectralAttention(embed_dim=embed_dim, n_eigenvectors=n_eig,
                                              n_heads=H, chunk_size=chunk_size).to(device)
    
            # Measure non-chunked memory usage
            torch.cuda.empty_cache()
            torch.cuda.reset_peak_memory_stats(device)
            with torch.no_grad():
                _ = _non_chunked_causal_cumsum(k_cuda, v_cuda)
            non_chunked_actual_mb = torch.cuda.max_memory_allocated(device) / (1024 ** 2)
    
            # Measure chunked memory usage
            torch.cuda.empty_cache()
            torch.cuda.reset_peak_memory_stats(device)
            with torch.no_grad():
                _ = attn_cuda._chunked_causal_cumsum(k_cuda, v_cuda)
            chunked_actual_mb = torch.cuda.max_memory_allocated(device) / (1024 ** 2)
    
            actual_reduction_pct = ((non_chunked_actual_mb - chunked_actual_mb) / non_chunked_actual_mb) * 100
    
            print(f"\nCUDA Actual Memory Usage:")
            print(f"Non-chunked actual: {non_chunked_actual_mb:.2f} MB")
            print(f"Chunked actual:     {chunked_actual_mb:.2f} MB")
            print(f"Actual reduction:   {actual_reduction_pct:.1f}%")
            print(f"{'='*60}\n")
    
            # Verify actual memory reduction
>           assert actual_reduction_pct >= 30.0, \
                f"Actual CUDA memory reduction {actual_reduction_pct:.1f}% is below threshold"
E           AssertionError: Actual CUDA memory reduction -17.9% is below threshold
E           assert -17.88957142298198 >= 30.0

neuromanifold_gpt/tests/test_spectral_chunked.py:292: AssertionError
----------------------------- Captured stdout call -----------------------------

============================================================
Memory Benchmark: T=1024, n_eig=32, chunk_size=128
============================================================
Configuration: B=16, H=8, T=1024, n_eig=32
Non-chunked peak memory: 512.00 MB (134,217,728 elements)
Chunked peak memory:     64.50 MB (16,908,288 elements)
Memory reduction:        87.4%
============================================================

CUDA Actual Memory Usage:
Non-chunked actual: 1073.25 MB
Chunked actual:     1265.25 MB
Actual reduction:   -17.9%
============================================================

_________________________ test_topographic_loss_basic __________________________

    def test_topographic_loss_basic():
        vocab_size = 100
        batch_size = 2
        seq_len = 8
    
        encoder = SemanticFoldingEncoder(
            vocab_size=vocab_size,
            sdr_size=2048,
            n_active=40,
            embed_dim=256,
        )
        encoder.train()
    
        tokens = torch.randint(0, vocab_size, (batch_size, seq_len))
    
>       sdr, scores, topo_loss = encoder(tokens)
E       ValueError: too many values to unpack (expected 3)

neuromanifold_gpt/tests/test_topographic_loss.py:22: ValueError
________________________ test_topographic_loss_gradient ________________________

    def test_topographic_loss_gradient():
        vocab_size = 50
        batch_size = 2
        seq_len = 4
    
        encoder = SemanticFoldingEncoder(
            vocab_size=vocab_size,
            sdr_size=2048,
            n_active=40,
            embed_dim=128,
        )
        encoder.train()
    
        tokens = torch.randint(0, vocab_size, (batch_size, seq_len))
    
>       sdr, scores, topo_loss = encoder(tokens)
E       ValueError: too many values to unpack (expected 3)

neuromanifold_gpt/tests/test_topographic_loss.py:51: ValueError
_______________________ test_topographic_loss_inference ________________________

    def test_topographic_loss_inference():
        vocab_size = 50
        batch_size = 1
        seq_len = 4
    
        encoder = SemanticFoldingEncoder(
            vocab_size=vocab_size,
            sdr_size=2048,
            n_active=40,
        )
        encoder.eval()
    
        tokens = torch.randint(0, vocab_size, (batch_size, seq_len))
    
        with torch.no_grad():
>           sdr, scores, topo_loss = encoder(tokens)
E           ValueError: too many values to unpack (expected 3)

neuromanifold_gpt/tests/test_topographic_loss.py:81: ValueError
__________________________ test_lightning_module_init __________________________

    def test_lightning_module_init():
        """Lightning module should initialize."""
        from neuromanifold_gpt.config import NeuroManifoldConfigNano
>       from neuromanifold_gpt.train import NeuroManifoldLightning

neuromanifold_gpt/tests/test_train.py:10: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/train.py:11: in <module>
    import lightning as L
venv/lib/python3.12/site-packages/lightning/__init__.py:20: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/__init__.py:27: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/__init__.py:14: in <module>
    from lightning.pytorch.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/batch_size_finder.py:26: in <module>
    from lightning.pytorch.callbacks.callback import Callback
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/callback.py:22: in <module>
    from lightning.pytorch.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/lightning/pytorch/utilities/types.py:40: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
______________________________ test_training_step ______________________________

    def test_training_step():
        """Training step should return loss."""
        from neuromanifold_gpt.config import NeuroManifoldConfigNano
>       from neuromanifold_gpt.train import NeuroManifoldLightning

neuromanifold_gpt/tests/test_train.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/train.py:11: in <module>
    import lightning as L
venv/lib/python3.12/site-packages/lightning/__init__.py:20: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/__init__.py:27: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/__init__.py:14: in <module>
    from lightning.pytorch.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/batch_size_finder.py:26: in <module>
    from lightning.pytorch.callbacks.callback import Callback
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/callback.py:22: in <module>
    from lightning.pytorch.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/lightning/pytorch/utilities/types.py:40: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
__________________________ test_configure_optimizers ___________________________

    def test_configure_optimizers():
        """Should return optimizer and scheduler."""
        from neuromanifold_gpt.config import NeuroManifoldConfigNano
>       from neuromanifold_gpt.train import NeuroManifoldLightning

neuromanifold_gpt/tests/test_train.py:36: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/train.py:11: in <module>
    import lightning as L
venv/lib/python3.12/site-packages/lightning/__init__.py:20: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/__init__.py:27: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/__init__.py:14: in <module>
    from lightning.pytorch.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/batch_size_finder.py:26: in <module>
    from lightning.pytorch.callbacks.callback import Callback
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/callback.py:22: in <module>
    from lightning.pytorch.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/lightning/pytorch/utilities/types.py:40: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
_____________________________ test_validation_step _____________________________

    def test_validation_step():
        """Validation step should return loss."""
        from neuromanifold_gpt.config import NeuroManifoldConfigNano
>       from neuromanifold_gpt.train import NeuroManifoldLightning

neuromanifold_gpt/tests/test_train.py:47: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/train.py:11: in <module>
    import lightning as L
venv/lib/python3.12/site-packages/lightning/__init__.py:20: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/__init__.py:27: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/__init__.py:14: in <module>
    from lightning.pytorch.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/batch_size_finder.py:26: in <module>
    from lightning.pytorch.callbacks.callback import Callback
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/callback.py:22: in <module>
    from lightning.pytorch.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/lightning/pytorch/utilities/types.py:40: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
____________________ test_optimizer_has_weight_decay_groups ____________________

    def test_optimizer_has_weight_decay_groups():
        """Optimizer should have separate weight decay groups."""
        from neuromanifold_gpt.config import NeuroManifoldConfigNano
>       from neuromanifold_gpt.train import NeuroManifoldLightning

neuromanifold_gpt/tests/test_train.py:63: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/train.py:11: in <module>
    import lightning as L
venv/lib/python3.12/site-packages/lightning/__init__.py:20: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/__init__.py:27: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/__init__.py:14: in <module>
    from lightning.pytorch.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/batch_size_finder.py:26: in <module>
    from lightning.pytorch.callbacks.callback import Callback
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/callback.py:22: in <module>
    from lightning.pytorch.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/lightning/pytorch/utilities/types.py:40: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
___________________________ test_scheduler_is_cosine ___________________________

    def test_scheduler_is_cosine():
        """Should return cosine annealing scheduler."""
        from neuromanifold_gpt.config import NeuroManifoldConfigNano
>       from neuromanifold_gpt.train import NeuroManifoldLightning

neuromanifold_gpt/tests/test_train.py:82: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/train.py:11: in <module>
    import lightning as L
venv/lib/python3.12/site-packages/lightning/__init__.py:20: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/__init__.py:27: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/__init__.py:14: in <module>
    from lightning.pytorch.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/batch_size_finder.py:26: in <module>
    from lightning.pytorch.callbacks.callback import Callback
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/callback.py:22: in <module>
    from lightning.pytorch.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/lightning/pytorch/utilities/types.py:40: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
_______________________ test_training_step_logs_metrics ________________________

    def test_training_step_logs_metrics():
        """Training step should log train_loss."""
        from neuromanifold_gpt.config import NeuroManifoldConfigNano
>       from neuromanifold_gpt.train import NeuroManifoldLightning

neuromanifold_gpt/tests/test_train.py:96: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/train.py:11: in <module>
    import lightning as L
venv/lib/python3.12/site-packages/lightning/__init__.py:20: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/__init__.py:27: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/__init__.py:14: in <module>
    from lightning.pytorch.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/batch_size_finder.py:26: in <module>
    from lightning.pytorch.callbacks.callback import Callback
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/callback.py:22: in <module>
    from lightning.pytorch.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/lightning/pytorch/utilities/types.py:40: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
_______________________________ test_train_smoke _______________________________

    def test_train_smoke():
        """Training should start with zero configuration."""
        from neuromanifold_gpt.config import NeuroManifoldConfigNano
>       from neuromanifold_gpt.train import NeuroManifoldLightning

neuromanifold_gpt/tests/test_train.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/train.py:11: in <module>
    import lightning as L
venv/lib/python3.12/site-packages/lightning/__init__.py:20: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/__init__.py:27: in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/__init__.py:14: in <module>
    from lightning.pytorch.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/batch_size_finder.py:26: in <module>
    from lightning.pytorch.callbacks.callback import Callback
venv/lib/python3.12/site-packages/lightning/pytorch/callbacks/callback.py:22: in <module>
    from lightning.pytorch.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/lightning/pytorch/utilities/types.py:40: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
________________ TestGPTConfigureOptimizers.test_num_parameters ________________

self = <neuromanifold_gpt.tests.test_train.TestGPTConfigureOptimizers object at 0x7fac877cd280>

    def test_num_parameters(self):
        """Should count parameters correctly."""
        from neuromanifold_gpt.config import NeuroManifoldConfigNano
        from neuromanifold_gpt.model.gpt import NeuroManifoldGPT
    
        config = NeuroManifoldConfigNano()
        model = NeuroManifoldGPT(config)
    
        n_params_total = model.num_parameters(non_embedding=False)
        n_params_no_embed = model.num_parameters(non_embedding=True)
    
>       assert n_params_total > n_params_no_embed
E       assert 15510356 > 15510356

neuromanifold_gpt/tests/test_train.py:295: AssertionError
______________ TestNanoGPTTrainingLoop.test_model_mixed_precision ______________

self = <neuromanifold_gpt.tests.test_train.TestNanoGPTTrainingLoop object at 0x7fac877ccf50>

    def test_model_mixed_precision(self):
        """Model should work with mixed precision."""
        from neuromanifold_gpt.config import NeuroManifoldConfigNano
        from neuromanifold_gpt.model.gpt import NeuroManifoldGPT
    
        config = NeuroManifoldConfigNano()
        model = NeuroManifoldGPT(config)
    
        x = torch.randint(0, config.vocab_size, (2, 32))
        y = torch.randint(0, config.vocab_size, (2, 32))
    
        # Simulate mixed precision
        with torch.amp.autocast('cpu', dtype=torch.bfloat16):
>           logits, loss, info = model(x, y)

neuromanifold_gpt/tests/test_train.py:356: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: in _call_impl
    return forward_call(*args, **kwargs)
neuromanifold_gpt/model/gpt.py:403: in forward
    x, info = block(x)
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: in _call_impl
    return forward_call(*args, **kwargs)
neuromanifold_gpt/model/block.py:232: in forward
    coords, metric = self.manifold(sdr)
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1511: in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
venv/lib/python3.12/site-packages/torch/nn/modules/module.py:1520: in _call_impl
    return forward_call(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = ManifoldProjection(
  (encoder): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): Lay...res=32, out_features=32, bias=True)
    (1): SiLU()
    (2): Linear(in_features=32, out_features=1024, bias=True)
  )
)
sdr = tensor([[[ 9.9694e-01,  7.0586e-01,  1.1576e+00,  ...,  3.2040e+00,
           1.1191e+01,  5.6463e+00],
         [ 1....+00, -7.0156e-01, -5.7396e-01,  ..., -1.1262e-02,
          -9.7169e-02,  6.3931e-03]]], grad_fn=<UnsafeViewBackward0>)

    def forward(self, sdr: torch.Tensor) -> tuple[torch.Tensor, torch.Tensor]:
        """
        Project SDRs to manifold.
    
        Args:
            sdr: (B, T, sdr_size) input SDR vectors
    
        Returns:
            coords: (B, T, manifold_dim) manifold coordinates
            metric: (B, T, manifold_dim, manifold_dim) positive definite metric tensor
        """
        # Project SDRs to manifold coordinates
        coords = self.encoder(sdr)
    
        # Compute local metric tensor
        metric_flat = self.metric_net(coords)
        B, T, _ = coords.shape
        A = metric_flat.view(B, T, self.manifold_dim, self.manifold_dim)
    
        # G = A^T A + I ensures positive definite
        # Using einsum: A^T A means contracting on the last dimension of A^T and A
        metric = einsum(A, A, "b t i j, b t k j -> b t i k")
    
        # Add I for numerical stability
>       eye = torch.eye(self.manifold_dim, device=metric.device, dtype=metric.dtype)
E       RuntimeError: "eye" not implemented for 'BFloat16'

neuromanifold_gpt/model/manifold.py:100: RuntimeError
_______________________ test_train_config_initialization _______________________

    def test_train_config_initialization():
        """TrainConfig should initialize with defaults."""
>       from neuromanifold_gpt.training.config import TrainConfig

neuromanifold_gpt/tests/test_training_modules.py:14: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
______________________ test_memmap_dataset_initialization ______________________

    def test_memmap_dataset_initialization():
        """MemmapDataset should initialize with data file."""
>       from neuromanifold_gpt.training.data_modules import MemmapDataset

neuromanifold_gpt/tests/test_training_modules.py:43: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
_____________________ test_text_data_module_initialization _____________________

    def test_text_data_module_initialization():
        """TextDataModule should initialize."""
>       from neuromanifold_gpt.training.data_modules import TextDataModule

neuromanifold_gpt/tests/test_training_modules.py:63: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
_________________________ test_text_data_module_setup __________________________

    def test_text_data_module_setup():
        """TextDataModule should setup with memmap files."""
>       from neuromanifold_gpt.training.data_modules import TextDataModule

neuromanifold_gpt/tests/test_training_modules.py:77: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
__________________ test_streaming_data_module_initialization ___________________

    def test_streaming_data_module_initialization():
        """StreamingDataModule should initialize."""
>       from neuromanifold_gpt.training.data_modules import StreamingDataModule

neuromanifold_gpt/tests/test_training_modules.py:111: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
_____________________ test_lightning_module_initialization _____________________

    def test_lightning_module_initialization():
        """NeuroManifoldLitModule should initialize."""
>       from neuromanifold_gpt.training.lightning_module import NeuroManifoldLitModule

neuromanifold_gpt/tests/test_training_modules.py:126: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
_____________________ test_lightning_module_training_step ______________________

    def test_lightning_module_training_step():
        """NeuroManifoldLitModule training step should work."""
>       from neuromanifold_gpt.training.lightning_module import NeuroManifoldLitModule

neuromanifold_gpt/tests/test_training_modules.py:137: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
____________________ test_lightning_module_validation_step _____________________

    def test_lightning_module_validation_step():
        """NeuroManifoldLitModule validation step should work."""
>       from neuromanifold_gpt.training.lightning_module import NeuroManifoldLitModule

neuromanifold_gpt/tests/test_training_modules.py:155: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
__________________ test_lightning_module_configure_optimizers __________________

    def test_lightning_module_configure_optimizers():
        """NeuroManifoldLitModule should configure optimizer and scheduler."""
>       from neuromanifold_gpt.training.lightning_module import NeuroManifoldLitModule

neuromanifold_gpt/tests/test_training_modules.py:173: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
________________ test_sample_generation_callback_initialization ________________

    def test_sample_generation_callback_initialization():
        """SampleGenerationCallback should initialize."""
>       from neuromanifold_gpt.training.callbacks import SampleGenerationCallback

neuromanifold_gpt/tests/test_training_modules.py:194: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
_______________________ test_mfu_callback_initialization _______________________

    def test_mfu_callback_initialization():
        """MFUCallback should initialize."""
>       from neuromanifold_gpt.training.callbacks import MFUCallback

neuromanifold_gpt/tests/test_training_modules.py:210: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
___________________________ test_integration_imports ___________________________

    def test_integration_imports():
        """All training components should be importable from training submodules."""
        from neuromanifold_gpt.training.config import TrainConfig
>       from neuromanifold_gpt.training.data_modules import (
            MemmapDataset,
            TextDataModule,
            StreamingDataModule,
        )

neuromanifold_gpt/tests/test_training_modules.py:220: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
_______________________ test_integration_data_to_module ________________________

    def test_integration_data_to_module():
        """Integration: Data module should work with Lightning module."""
>       from neuromanifold_gpt.training.data_modules import TextDataModule

neuromanifold_gpt/tests/test_training_modules.py:245: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
______________________ test_integration_config_to_module _______________________

    def test_integration_config_to_module():
        """Integration: TrainConfig should configure Lightning module."""
        from neuromanifold_gpt.training.config import TrainConfig
>       from neuromanifold_gpt.training.lightning_module import NeuroManifoldLitModule

neuromanifold_gpt/tests/test_training_modules.py:292: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
__________________ test_callbacks_work_with_lightning_module ___________________

    def test_callbacks_work_with_lightning_module():
        """Integration: Callbacks should work with Lightning module."""
>       from neuromanifold_gpt.training.lightning_module import NeuroManifoldLitModule

neuromanifold_gpt/tests/test_training_modules.py:328: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
______________________ test_lightning_module_logs_metrics ______________________

    def test_lightning_module_logs_metrics():
        """Lightning module should log metrics during training."""
>       from neuromanifold_gpt.training.lightning_module import NeuroManifoldLitModule

neuromanifold_gpt/tests/test_training_modules.py:371: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
____________________ test_module_has_all_config_attributes _____________________

    def test_module_has_all_config_attributes():
        """Lightning module should preserve config attributes."""
>       from neuromanifold_gpt.training.lightning_module import NeuroManifoldLitModule

neuromanifold_gpt/tests/test_training_modules.py:405: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
neuromanifold_gpt/training/__init__.py:28: in <module>
    from neuromanifold_gpt.training.data_modules import (
neuromanifold_gpt/training/data_modules.py:16: in <module>
    import pytorch_lightning as pl
venv/lib/python3.12/site-packages/pytorch_lightning/__init__.py:27: in <module>
    from pytorch_lightning.callbacks import Callback  # noqa: E402
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/__init__.py:14: in <module>
    from pytorch_lightning.callbacks.batch_size_finder import BatchSizeFinder
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/batch_size_finder.py:26: in <module>
    from pytorch_lightning.callbacks.callback import Callback
venv/lib/python3.12/site-packages/pytorch_lightning/callbacks/callback.py:22: in <module>
    from pytorch_lightning.utilities.types import STEP_OUTPUT
venv/lib/python3.12/site-packages/pytorch_lightning/utilities/types.py:36: in <module>
    from torchmetrics import Metric
venv/lib/python3.12/site-packages/torchmetrics/__init__.py:31: in <module>
    import scipy.signal
venv/lib/python3.12/site-packages/scipy/__init__.py:67: in <module>
    _fun = getattr(np, _key)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

attr = 'testing'

    def __getattr__(attr):
        # Warn for expired attributes
        import warnings
    
        if attr == "linalg":
            import numpy.linalg as linalg
            return linalg
        elif attr == "fft":
            import numpy.fft as fft
            return fft
        elif attr == "dtypes":
            import numpy.dtypes as dtypes
            return dtypes
        elif attr == "random":
            import numpy.random as random
            return random
        elif attr == "polynomial":
            import numpy.polynomial as polynomial
            return polynomial
        elif attr == "ma":
            import numpy.ma as ma
            return ma
        elif attr == "ctypeslib":
            import numpy.ctypeslib as ctypeslib
            return ctypeslib
        elif attr == "exceptions":
            import numpy.exceptions as exceptions
            return exceptions
        elif attr == "testing":
>           import numpy.testing as testing
E           ModuleNotFoundError: No module named 'numpy.testing'

/home/mikeb/Applications/Auto-Claude/resources/python-site-packages/numpy/__init__.py:733: ModuleNotFoundError
=============================== warnings summary ===============================
venv/lib/python3.12/site-packages/torch/nn/modules/transformer.py:20
  /home/mikeb/work/nano/.auto-claude/worktrees/tasks/052-reduce-neuromanifoldblock-parameter-explosion-with/venv/lib/python3.12/site-packages/torch/nn/modules/transformer.py:20: UserWarning: Failed to initialize NumPy: _ARRAY_API not found (Triggered internally at ../torch/csrc/utils/tensor_numpy.cpp:84.)
    device: torch.device = torch.device(torch._C._get_default_device()),  # torch.device('cpu'),

neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeAll::test_compute_all_scalar_tensors
neuromanifold_gpt/tests/test_fhn_metrics.py::TestEdgeCases::test_single_value_tensors
  /home/mikeb/work/nano/.auto-claude/worktrees/tasks/052-reduce-neuromanifoldblock-parameter-explosion-with/neuromanifold_gpt/evaluation/fhn_metrics.py:45: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at ../aten/src/ATen/native/ReduceOps.cpp:1760.)
    'fhn_state_std': fhn_state.std().item(),

neuromanifold_gpt/tests/test_fhn_metrics.py::TestComputeAll::test_compute_all_scalar_tensors
  /home/mikeb/work/nano/.auto-claude/worktrees/tasks/052-reduce-neuromanifoldblock-parameter-explosion-with/neuromanifold_gpt/evaluation/fhn_metrics.py:71: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at ../aten/src/ATen/native/ReduceOps.cpp:1760.)
    'pulse_width_std': pulse_widths.std().item(),

neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeOverlapStatistics::test_overlap_identical_sdrs
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeOverlapStatistics::test_overlap_disjoint_sdrs
neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeOverlapStatistics::test_overlap_partial
neuromanifold_gpt/tests/test_sdr_metrics.py::TestEdgeCases::test_overlap_with_empty_sdr
  /home/mikeb/work/nano/.auto-claude/worktrees/tasks/052-reduce-neuromanifoldblock-parameter-explosion-with/neuromanifold_gpt/evaluation/sdr_metrics.py:124: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at ../aten/src/ATen/native/ReduceOps.cpp:1760.)
    'overlap_std': unique_overlaps.std().item(),

neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeAll::test_compute_all_empty_batch
  /home/mikeb/work/nano/.auto-claude/worktrees/tasks/052-reduce-neuromanifoldblock-parameter-explosion-with/neuromanifold_gpt/evaluation/sdr_metrics.py:162: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at ../aten/src/ATen/native/ReduceOps.cpp:1760.)
    'sparsity_std': sparsity.std().item(),

neuromanifold_gpt/tests/test_sdr_metrics.py::TestComputeAll::test_compute_all_empty_batch
  /home/mikeb/work/nano/.auto-claude/worktrees/tasks/052-reduce-neuromanifoldblock-parameter-explosion-with/neuromanifold_gpt/evaluation/sdr_metrics.py:164: UserWarning: std(): degrees of freedom is <= 0. Correction should be strictly less than the reduction factor (input numel divided by output numel). (Triggered internally at ../aten/src/ATen/native/ReduceOps.cpp:1760.)
    'entropy_std': entropy.std().item(),

neuromanifold_gpt/tests/test_sdr_metrics.py::TestEdgeCases::test_numerical_stability_entropy
  /home/mikeb/work/nano/.auto-claude/worktrees/tasks/052-reduce-neuromanifoldblock-parameter-explosion-with/neuromanifold_gpt/tests/test_sdr_metrics.py:322: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
    assert torch.isfinite(torch.tensor(entropy))

neuromanifold_gpt/tests/test_train.py::test_lightning_module_init
  /home/mikeb/work/nano/.auto-claude/worktrees/tasks/052-reduce-neuromanifoldblock-parameter-explosion-with/venv/lib/python3.12/site-packages/lightning/fabric/__init__.py:40: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.

neuromanifold_gpt/tests/test_train.py::test_lightning_module_init
  /home/mikeb/work/nano/.auto-claude/worktrees/tasks/052-reduce-neuromanifoldblock-parameter-explosion-with/venv/lib/python3.12/site-packages/lightning/fabric/__init__.py:40: Deprecated call to `pkg_resources.declare_namespace('lightning.fabric')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages

neuromanifold_gpt/tests/test_train.py::test_lightning_module_init
  /home/mikeb/work/nano/.auto-claude/worktrees/tasks/052-reduce-neuromanifoldblock-parameter-explosion-with/venv/lib/python3.12/site-packages/pkg_resources/__init__.py:2558: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('lightning')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED neuromanifold_gpt/tests/test_config.py::TestNeuroManifoldConfig::test_config_n_embd_divisible_by_heads
FAILED neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderMask::test_mask_caching
FAILED neuromanifold_gpt/tests/test_context_encoder.py::TestContextEncoderValidation::test_invalid_n_heads
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_forward_shape
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_node_count_bounds
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_acyclic_structure
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_node_mask_consistency
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_adjacency_mask_application
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_deterministic_mode
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_complexity_positive
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_complexity_masking
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_surface_area_calculation
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_execution_order
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_execution_order_respects_dependencies
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_gradient_flow
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_batch_independence
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_empty_adjacency
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_training_vs_eval_mode
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_manifold_projection
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_different_sequence_lengths
FAILED neuromanifold_gpt/tests/test_dag_planner.py::test_dag_planner_device_movement
FAILED neuromanifold_gpt/tests/test_ema.py::TestEMANumericalStability::test_ema_alpha_boundary
FAILED neuromanifold_gpt/tests/test_ema.py::TestEMAComplexity::test_ema_time_complexity
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_output_shapes_match
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_gradient_flow_old_path
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_gradient_flow_new_path
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_fhn_state_computed_both_paths
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_no_fhn_steps_matches_flash_attention
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_output_stats_computed_both_paths
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_various_sequence_lengths
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_various_batch_sizes
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_deterministic_with_fixed_seed
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_outputs_are_different_due_to_different_proxies
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_pulse_widths_positive_both_paths
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_backward_compatibility_flag_default
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_new_path_attn_probs_is_none
FAILED neuromanifold_gpt/tests/test_fhn_flash_fusion.py::test_old_path_attn_probs_exists
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_store_retrieve
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_total_capacity
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_empty_retrieval
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_clear
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_get_stats
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_similarity_threshold
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_partial_overlap_retrieval
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_hierarchical_multiple_retrieval
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_correctness
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_performance
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_with_l1_overflow
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_with_l2_overflow
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_empty
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_single_item
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_store_batch_equivalence
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_tier_promotion_l1_to_l2
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_tier_promotion_l2_to_l3
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_tier_promotion_cascade
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_capacity_l1_limit
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_capacity_l2_limit
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_capacity_l3_limit
FAILED neuromanifold_gpt/tests/test_hierarchical_engram.py::test_capacity_total_limit
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_store_retrieve_l1
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_tier_stats
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_l1_to_l2_demotion
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_l2_to_l3_demotion
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_l2_to_l1_promotion
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_l3_to_l1_promotion
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_retrieval_across_tiers
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_similarity_threshold
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_clear
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_empty_retrieval
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_top_k_limit
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_capacity_enforcement
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_partial_overlap_retrieval
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_multiple_retrieval_sorted
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_device_movement
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_access_count_tracking
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_tier_override_threshold
FAILED neuromanifold_gpt/tests/test_hierarchical_memory.py::test_hierarchical_len_method
FAILED neuromanifold_gpt/tests/test_imagination.py::TestImaginationOutputShapes::test_imagination_output_shape_no_goal
FAILED neuromanifold_gpt/tests/test_imagination.py::TestImaginationOutputShapes::test_imagination_output_shape_with_goal
FAILED neuromanifold_gpt/tests/test_imagination.py::TestImaginationOutputShapes::test_imagination_various_n_alternatives
FAILED neuromanifold_gpt/tests/test_imagination.py::TestImaginationOutputShapes::test_imagination_single_token
FAILED neuromanifold_gpt/tests/test_imagination.py::TestImaginationOutputShapes::test_imagination_various_embed_dims
FAILED neuromanifold_gpt/tests/test_imagination.py::TestImaginationSteps::test_imagination_two_steps
FAILED neuromanifold_gpt/tests/test_imagination.py::TestImaginationSteps::test_imagination_four_steps
FAILED neuromanifold_gpt/tests/test_imagination.py::TestImaginationSteps::test_noise_schedule_properties
FAILED neuromanifold_gpt/tests/test_imagination.py::TestGoalConditioning::test_goal_conditioning_affects_output
FAILED neuromanifold_gpt/tests/test_imagination.py::TestGoalConditioning::test_goal_affects_scores
FAILED neuromanifold_gpt/tests/test_imagination.py::TestScoreProperties::test_scores_finite
FAILED neuromanifold_gpt/tests/test_imagination.py::TestScoreProperties::test_best_matches_highest_score
FAILED neuromanifold_gpt/tests/test_imagination.py::TestScoreProperties::test_scores_vary_across_alternatives
FAILED neuromanifold_gpt/tests/test_imagination.py::TestGradientFlow::test_gradient_through_alternatives
FAILED neuromanifold_gpt/tests/test_imagination.py::TestGradientFlow::test_gradient_through_scores
FAILED neuromanifold_gpt/tests/test_imagination.py::TestGradientFlow::test_gradient_through_best
FAILED neuromanifold_gpt/tests/test_imagination.py::TestGradientFlow::test_gradient_with_goal
FAILED neuromanifold_gpt/tests/test_imagination.py::TestDeterminism::test_eval_mode_deterministic_with_seed
FAILED neuromanifold_gpt/tests/test_imagination.py::TestDeterminism::test_different_seeds_produce_different_results
FAILED neuromanifold_gpt/tests/test_imagination.py::TestDropout::test_dropout_training_mode
FAILED neuromanifold_gpt/tests/test_imagination.py::TestDropout::test_dropout_eval_mode
FAILED neuromanifold_gpt/tests/test_imagination.py::TestBatchSizeVariations::test_single_batch
FAILED neuromanifold_gpt/tests/test_imagination.py::TestBatchSizeVariations::test_large_batch
FAILED neuromanifold_gpt/tests/test_imagination.py::TestInternalComponents::test_denoiser_output_shape
FAILED neuromanifold_gpt/tests/test_imagination.py::TestInternalComponents::test_goal_encoder_output_shape
FAILED neuromanifold_gpt/tests/test_imagination.py::TestInternalComponents::test_scorer_output_shape
FAILED neuromanifold_gpt/tests/test_manifold.py::TestGradientFlow::test_gradient_through_metric
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_learned_pos_emb_forward
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_ramanujan_pos_emb_forward
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_rotary_pos_emb_forward
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_alibi_pos_emb_forward
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_targets[learned]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_targets[ramanujan]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_targets[rotary]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_targets[alibi]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_generate[learned]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_generate[ramanujan]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_generate[rotary]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_generate[alibi]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_produce_different_outputs[learned]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_produce_different_outputs[ramanujan]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_produce_different_outputs[rotary]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_produce_different_outputs[alibi]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_info_dict[learned]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_info_dict[ramanujan]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_info_dict[rotary]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_info_dict[alibi]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_learned_vs_ramanujan_different_positions
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_rotary_vs_alibi_different_mechanisms
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_gradient_flow[learned]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_gradient_flow[ramanujan]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_gradient_flow[rotary]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_gradient_flow[alibi]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_batch_size_independence[learned]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_batch_size_independence[ramanujan]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_batch_size_independence[rotary]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_batch_size_independence[alibi]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_sequence_length_independence[learned]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_sequence_length_independence[ramanujan]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_sequence_length_independence[rotary]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_sequence_length_independence[alibi]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_learned_pos_emb_initialization
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_ramanujan_pos_emb_initialization
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_rotary_pos_emb_initialization
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_alibi_pos_emb_initialization
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_invalid_pos_emb_type
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_deterministic[learned]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_deterministic[ramanujan]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_deterministic[rotary]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_deterministic[alibi]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_memory_efficiency[learned]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_memory_efficiency[ramanujan]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_memory_efficiency[rotary]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_memory_efficiency[alibi]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_rotary_extrapolation_capability
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_alibi_extrapolation_capability
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_sdr[learned]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_sdr[ramanujan]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_sdr[rotary]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_all_pos_emb_types_with_sdr[alibi]
FAILED neuromanifold_gpt/tests/test_position_embeddings.py::test_pos_emb_type_saved_in_config
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderOutputShape::test_encoder_output_shape
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderOutputShape::test_encoder_single_token
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderOutputShape::test_encoder_batch_sizes
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderSparsity::test_encoder_sparsity
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderSparsity::test_encoder_binary_values
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderSparsity::test_training_mode_sparsity
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestSemanticSimilarity::test_semantic_similarity_self
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestSemanticSimilarity::test_semantic_similarity_different_tokens
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestPhraseEncoding::test_encode_phrase
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestPhraseEncoding::test_encode_phrase_batched
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestGradientFlow::test_gradient_through_encoder
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestGradientFlow::test_gradient_through_sdr
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestDeterminism::test_eval_mode_deterministic
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestEncoderComponents::test_context_encoder_integration
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestBoostingMechanism::test_boosting_updates_duty_cycle
FAILED neuromanifold_gpt/tests/test_semantic_folding.py::TestBoostingMechanism::test_boosting_disabled_in_eval
FAILED neuromanifold_gpt/tests/test_spectral.py::test_spectral_basis_normalized
FAILED neuromanifold_gpt/tests/test_spectral_chunked.py::TestChunkedSpectralAttention::test_memory_usage
FAILED neuromanifold_gpt/tests/test_topographic_loss.py::test_topographic_loss_basic
FAILED neuromanifold_gpt/tests/test_topographic_loss.py::test_topographic_loss_gradient
FAILED neuromanifold_gpt/tests/test_topographic_loss.py::test_topographic_loss_inference
FAILED neuromanifold_gpt/tests/test_train.py::test_lightning_module_init - Mo...
FAILED neuromanifold_gpt/tests/test_train.py::test_training_step - ModuleNotF...
FAILED neuromanifold_gpt/tests/test_train.py::test_configure_optimizers - Mod...
FAILED neuromanifold_gpt/tests/test_train.py::test_validation_step - ModuleNo...
FAILED neuromanifold_gpt/tests/test_train.py::test_optimizer_has_weight_decay_groups
FAILED neuromanifold_gpt/tests/test_train.py::test_scheduler_is_cosine - Modu...
FAILED neuromanifold_gpt/tests/test_train.py::test_training_step_logs_metrics
FAILED neuromanifold_gpt/tests/test_train.py::test_train_smoke - ModuleNotFou...
FAILED neuromanifold_gpt/tests/test_train.py::TestGPTConfigureOptimizers::test_num_parameters
FAILED neuromanifold_gpt/tests/test_train.py::TestNanoGPTTrainingLoop::test_model_mixed_precision
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_train_config_initialization
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_memmap_dataset_initialization
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_text_data_module_initialization
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_text_data_module_setup
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_streaming_data_module_initialization
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_lightning_module_initialization
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_lightning_module_training_step
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_lightning_module_validation_step
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_lightning_module_configure_optimizers
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_sample_generation_callback_initialization
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_mfu_callback_initialization
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_integration_imports
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_integration_data_to_module
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_integration_config_to_module
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_callbacks_work_with_lightning_module
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_lightning_module_logs_metrics
FAILED neuromanifold_gpt/tests/test_training_modules.py::test_module_has_all_config_attributes
================ 206 failed, 480 passed, 14 warnings in 48.36s =================
